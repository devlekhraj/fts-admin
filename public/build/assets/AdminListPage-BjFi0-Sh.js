import{_ as ea}from"./AppDataTable.vue_vue_type_script_setup_true_lang-UR6sUKPb.js";import{_ as ne,d as G,ak as ce,p as q,c as Z,a,b as t,T as W,al as me,f as h,t as j,W as fe,g as $,h as Ce,e as L,a2 as Ae,V as K,a5 as qe,F as Y,r as y,v as aa,x as la,am as ta,an as na,ao as sa,y as ke,ap as oa,w as de,K as Ie,aq as ra,B as ia,m as T,H as Q,I as ua,N as le,s as X,ar as Ue,as as Re,at as da,q as ca,P as ma,au as fa,z as va,av as pa,aw as ga,ax as Ee,a1 as ze,ay as ya,az as wa,aA as ba,n as _a,aB as Va,J as ka,o as Se,Y as ve,X as pe,k as te,l as U,j as ge,a7 as Fe,a3 as ha,R as xa,a6 as Ca}from"./main-DfI8oFa_.js";import{u as Aa,d as Sa,m as Pa,e as $a,f as Ia,g as Ua,h as Ra,i as Ea,V as he,j as Fa}from"./VDataTable-wVkXfD0J.js";import{V as qa,c as za,b as Da,a as Ma}from"./VTabs-D6qwPkO4.js";function La(l){return ne.get("/admin/admin-list",{params:l})}function Ba(l){return ne.post("/admin/admin-create",l)}function Ta(l){return ne.put(`/admin/admin-users/${l.id}/basic-info`,{name:l.name,username:l.username,role_id:l.role_id})}function Oa(l){return ne.put(`/admin/admin-users/${l.id}/password`,{password:l.password,confirm_password:l.confirm_password})}function ja(l){return ne.delete(`/admin/admin-users/${l}/delete`)}function ye(l){return l instanceof Error?l.message:"Unexpected error"}const Na={class:"mt-3 d-flex align-center justify-space-around py-6"},Wa={style:{width:"max-content"},class:"d-flex align-center"},Ka={class:"ml-3"},Ha={class:"font-weight-medium text-capitalize"},Ja={class:"text-medium-emphasis"},Qa={class:"w-100 d-flex align-center justify-space-around"},Xa=G({__name:"AdminDeleteModal",props:{admin:{}},emits:["close","saved"],setup(l,{emit:R}){const f=l,x=R,v=y(!1),d=y(""),o=ce();async function b(){if(d.value="",!f.admin?.id){d.value="Admin id is required.";return}v.value=!0;try{await ja(f.admin.id),o.show({message:"Admin deleted successfully.",color:"success"}),x("saved",{id:f.admin.id}),x("close")}catch(_){const i=_?.response,m=i?.data?.errors??null;if(i?.status===422&&m&&typeof m=="object"){const E={};for(const[z,V]of Object.entries(m))Array.isArray(V)?E[z]=V.map(w=>String(w)):V!=null&&(E[z]=[String(V)]);const C=E.id?.[0]??"Failed to delete admin.";d.value=C,o.show({message:C,color:"error"});return}const k=ye(_);d.value=k,o.show({message:k,color:"error"})}finally{v.value=!1}}return(_,i)=>(q(),Z(Y,null,[a(Ae,{class:"py-6"},{default:t(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[h(j(d.value),1)]),_:1})):fe("",!0),$("div",Na,[$("div",Wa,[a(Ce,{size:"40",color:"grey-lighten-3"},{default:t(()=>[a(L,{size:"22",color:"grey-darken-1"},{default:t(()=>[...i[0]||(i[0]=[h("mdi-account-circle",-1)])]),_:1})]),_:1}),$("div",Ka,[$("div",Ha,j(l.admin.name??"-"),1),$("div",Ja,"@"+j(l.admin.username??l.admin.email),1)])])])]),_:1}),a(qe,{class:"pb-4"},{default:t(()=>[$("div",Qa,[a(K,{color:"error",variant:"tonal",loading:v.value,disabled:v.value,onClick:b},{default:t(()=>[a(L,{start:""},{default:t(()=>[...i[1]||(i[1]=[h("mdi-delete",-1)])]),_:1}),i[2]||(i[2]=h(" Delete ",-1))]),_:1},8,["loading","disabled"])])]),_:1})],64))}});function Pe(){return ne.get("/admin/rbac/roles")}const Ya=ca({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...$a({filterKeys:["title"]}),...Pa(),...ma(fa({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VAutocomplete"),$e=aa()({name:"VAutocomplete",props:Ya(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,R){let{slots:f}=R;const{t:x}=la(),v=y(),d=le(!1),o=le(!0),b=le(!1),_=y(),i=y(),m=le(-1),k=le(null),{items:E,transformIn:C,transformOut:z}=ta(l),{textColorClasses:V,textColorStyles:w}=na(()=>v.value?.color),{InputIcon:p}=sa(l),u=ke(l,"search",""),e=ke(l,"modelValue",[],r=>C(r===null?[null]:va(r)),r=>{const S=z(r);return l.multiple?S:S[0]??null}),s=X(()=>typeof l.counterValue=="function"?l.counterValue(e.value):typeof l.counterValue=="number"?l.counterValue:e.value.length),n=oa(l),{filteredItems:c,getMatches:g}=Aa(l,E,()=>k.value??(o.value?"":u.value)),I=X(()=>l.hideSelected&&k.value===null?c.value.filter(r=>!e.value.some(S=>S.value===r.value)):c.value),N=ka(()=>l.closableChips&&!n.isReadonly.value&&!n.isDisabled.value),H=X(()=>!!(l.chips||f.chip)),ee=X(()=>H.value||!!f.selection),De=X(()=>e.value.map(r=>r.props.value)),se=X(()=>I.value.find(r=>r.type==="item"&&!r.props.disabled)),we=X(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&u.value===se.value?.title)&&I.value.length>0&&!o.value&&!b.value),ie=X(()=>l.hideNoData&&!I.value.length||n.isReadonly.value||n.isDisabled.value),be=ke(l,"menu"),D=X({get:()=>be.value,set:r=>{be.value&&!r&&_.value?.Î¨openChildren.size||r&&ie.value||(be.value=r)}}),{menuId:Me,ariaExpanded:Le,ariaControls:Be}=Sa(l,D),_e=y(),Te=Fa(_e,v);function Oe(r){l.openOnClear&&(D.value=!0),u.value=""}function je(){ie.value||(D.value=!0)}function Ne(r){ie.value||(d.value&&(r.preventDefault(),r.stopPropagation()),D.value=!D.value)}function We(r){(Ue(r)||r.key==="Backspace")&&v.value?.focus()}function Ke(r){if(n.isReadonly.value)return;const S=v.value?.selectionStart,M=e.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(r.key)&&r.preventDefault(),["Enter","ArrowDown"].includes(r.key)&&(D.value=!0),["Escape"].includes(r.key)&&(D.value=!1),we.value&&["Enter","Tab"].includes(r.key)&&se.value&&!e.value.some(P=>{let{value:B}=P;return B===se.value.value})&&ae(se.value),r.key==="ArrowDown"&&we.value&&_e.value?.focus("next"),["Backspace","Delete"].includes(r.key)){if(!l.multiple&&ee.value&&e.value.length>0&&!u.value)return ae(e.value[0],!1);if(~m.value){r.preventDefault();const P=m.value;ae(e.value[m.value],!1),m.value=P>=M-1?M-2:P}else r.key==="Backspace"&&!u.value&&(m.value=M-1);return}if(l.multiple)if(r.key==="ArrowLeft"){if(m.value<0&&S&&S>0)return;const P=m.value>-1?m.value-1:M-1;if(e.value[P])m.value=P;else{const B=u.value?.length??null;m.value=-1,v.value?.setSelectionRange(B,B)}}else if(r.key==="ArrowRight"){if(m.value<0)return;const P=m.value+1;e.value[P]?m.value=P:(m.value=-1,v.value?.setSelectionRange(0,0))}else~m.value&&Ue(r)&&(m.value=-1)}function He(r){if(Re(v.value,":autofill")||Re(v.value,":-webkit-autofill")){const S=E.value.find(M=>M.title===r.target.value);S&&ae(S)}}function Je(){l.eager&&i.value?.calculateVisibleItems()}function Qe(){d.value&&(o.value=!0,v.value?.focus()),k.value=null}function Xe(r){d.value=!0,setTimeout(()=>{b.value=!0})}function Ye(r){b.value=!1}function Ge(r){(r==null||r===""&&!l.multiple&&!ee.value)&&(e.value=[])}const Ve=le(!1);function ae(r){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!r||r.props.disabled))if(l.multiple){const M=e.value.findIndex(B=>(l.valueComparator||da)(B.value,r.value)),P=S??!~M;if(~M){const B=P?[...e.value,r]:[...e.value];B.splice(M,1),e.value=B}else P&&(e.value=[...e.value,r]);l.clearOnSelect&&(u.value="")}else{const M=S!==!1;e.value=M?[r]:[],k.value=o.value?"":u.value??"",u.value=M&&!ee.value?r.title:"",Ie(()=>{D.value=!1,o.value=!0})}}return de(d,(r,S)=>{r!==S&&(r?(Ve.value=!0,u.value=l.multiple||ee.value?"":String(e.value.at(-1)?.props.title??""),o.value=!0,Ie(()=>Ve.value=!1)):(!l.multiple&&u.value==null&&(e.value=[]),D.value=!1,!o.value&&u.value&&(k.value=u.value),u.value="",m.value=-1))}),de(u,r=>{!d.value||Ve.value||(r&&(D.value=!0),o.value=!r)}),de(D,r=>{if(!l.hideSelected&&r&&e.value.length&&o.value){const S=I.value.findIndex(M=>e.value.some(P=>M.value===P.value));ra&&window.requestAnimationFrame(()=>{S>=0&&i.value?.scrollToIndex(S)})}r&&(k.value=null)}),de(E,(r,S)=>{D.value||d.value&&!S.length&&r.length&&(D.value=!0)}),ia(()=>{const r=!!(!l.hideNoData||I.value.length||f["prepend-item"]||f["append-item"]||f["no-data"]),S=e.value.length>0,M=T.filterProps(l);return a(T,Q({ref:v},M,{modelValue:u.value,"onUpdate:modelValue":[P=>u.value=P,Ge],focused:d.value,"onUpdate:focused":P=>d.value=P,validationValue:e.externalValue,counterValue:s.value,dirty:S,onChange:He,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":D.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!ee.value,"v-autocomplete--selecting-index":m.value>-1},l.class],style:l.style,readonly:n.isReadonly.value,placeholder:S?void 0:l.placeholder,"onClick:clear":Oe,"onMousedown:control":je,onKeydown:Ke,"aria-expanded":Le.value,"aria-controls":Be.value}),{...f,default:P=>{let{id:B}=P;return $(Y,null,[a(Ia,Q({id:Me.value,ref:_,modelValue:D.value,"onUpdate:modelValue":F=>D.value=F,activator:"parent",contentClass:"v-autocomplete__content",disabled:ie.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:Je,onAfterLeave:Qe},l.menuProps),{default:()=>[r&&a(ga,Q({ref:_e,filterable:!0,selected:De.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:F=>F.preventDefault(),onKeydown:We,onFocusin:Xe,onFocusout:Ye,tabindex:"-1",selectable:!!I.value.length,"aria-live":"polite","aria-labelledby":`${B.value}-label`,"aria-multiselectable":l.multiple,color:l.itemColor??l.color},Te,l.listProps),{default:()=>[f["prepend-item"]?.(),!I.value.length&&!l.hideNoData&&(f["no-data"]?.()??a(Ee,{key:"no-data",title:x(l.noDataText)},null)),a(Ua,{ref:i,renderless:!0,items:I.value,itemKey:"value"},{default:F=>{let{item:A,index:J,itemRef:ue}=F;const oe=Q(A.props,{ref:ue,key:A.value,active:we.value&&A===se.value?!0:void 0,onClick:()=>ae(A,null),"aria-posinset":J+1,"aria-setsize":I.value.length});return A.type==="divider"?f.divider?.({props:A.raw,index:J})??a(ze,Q(A.props,{key:`divider-${J}`}),null):A.type==="subheader"?f.subheader?.({props:A.raw,index:J})??a(ya,Q(A.props,{key:`subheader-${J}`}),null):f.item?.({item:A,index:J,props:oe})??a(Ee,Q(oe,{role:"option"}),{prepend:re=>{let{isSelected:O}=re;return $(Y,null,[l.multiple&&!l.hideSelected?a(Ea,{key:A.value,modelValue:O,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Ze=>Ze.preventDefault()},null):void 0,A.props.prependAvatar&&a(Ce,{image:A.props.prependAvatar},null),A.props.prependIcon&&a(L,{icon:A.props.prependIcon},null)])},title:()=>o.value?A.title:Ra("v-autocomplete",A.title,g(A)?.title)})}}),f["append-item"]?.()]})]}),e.value.map((F,A)=>{function J(O){O.stopPropagation(),O.preventDefault(),ae(F,!1)}const ue=Q(he.filterProps(F.props),{"onClick:close":J,onKeydown(O){O.key!=="Enter"&&O.key!==" "||(O.preventDefault(),O.stopPropagation(),J(O))},onMousedown(O){O.preventDefault(),O.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),oe=H.value?!!f.chip:!!f.selection,re=oe?wa(H.value?f.chip({item:F,index:A,props:ue}):f.selection({item:F,index:A})):void 0;if(!(oe&&!re))return $("div",{key:F.value,class:_a(["v-autocomplete__selection",A===m.value&&["v-autocomplete__selection--selected",V.value]]),style:ba(A===m.value?w.value:{})},[H.value?f.chip?a(Va,{key:"chip-defaults",defaults:{VChip:{closable:N.value,size:"small",text:F.title}}},{default:()=>[re]}):a(he,Q({key:"chip",closable:N.value,size:"small",text:F.title,disabled:F.props.disabled},ue),null):re??$("span",{class:"v-autocomplete__selection-text"},[F.title,l.multiple&&A<e.value.length-1&&$("span",{class:"v-autocomplete__selection-comma"},[h(",")])])])})])},"append-inner":function(){for(var P=arguments.length,B=new Array(P),F=0;F<P;F++)B[F]=arguments[F];return $(Y,null,[f["append-inner"]?.(...B),l.menuIcon?a(L,{class:"v-autocomplete__menu-icon",color:v.value?.fieldIconColor,icon:l.menuIcon,onMousedown:Ne,onClick:pa,"aria-hidden":!0,tabindex:"-1"},null):void 0,l.appendInnerIcon&&a(p,{key:"append-icon",name:"appendInner",color:B[0].iconColor.value},null)])}})}),ua({isFocused:d,isPristine:o,menu:D,search:u,filteredItems:c,select:ae},v)}}),Ga={class:"px-6 pt-3"},Za=G({__name:"AdminUpdateBasicTab",props:{admin:{}},emits:["saved"],setup(l,{emit:R}){const f=l,x=R,v=y(),d=y([]),o=y(""),b=ce(),_=y(!1),i=y({name:f.admin?.name??"",username:f.admin?.username??"",role_id:f.admin?.role_id??null}),m=y({}),k={required:p=>p?!0:"Required",noSpaces:p=>!p||!/\s/.test(p)?!0:"Username must not contain spaces",lowercase:p=>!p||p===p.toLowerCase()?!0:"Username must be lowercase",allowedChars:p=>!p||/^[a-z0-9_.-]+$/.test(p)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:p=>!p||!p.startsWith(".")&&!p.endsWith(".")?!0:"Dot cannot be the first or last character"};async function E(){const{data:p}=await Pe(),u=Array.isArray(p)?p:p?.data??[];d.value=u.map(e=>({title:e?.name??"",value:e?.id??""})).filter(e=>e.title&&e.value!=="")}function C(p){typeof p=="string"&&(i.value.username=p.toLowerCase()),V("username")}function z(p){return m.value[p]??[]}function V(p){if(!m.value[p])return;const u={...m.value};delete u[p],m.value=u}async function w(){o.value="",m.value={};const p=await v.value?.validate?.();if(!(p&&p.valid===!1)&&!(!p&&v.value?.validate&&!await v.value.validate())){if(!f.admin?.id){o.value="Admin id is required.";return}_.value=!0;try{const u={id:f.admin.id,name:i.value.name,username:i.value.username,role_id:i.value.role_id},{data:e}=await Ta(u),s=e?.data?.updated??e?.updated??!0,n=e?.data?.message??e?.message??"",c=e?.data?.field??e?.field??"";if(s===!1){c?m.value={[c]:[n||"Invalid value."]}:(o.value=n||"Failed to update admin.",b.show({message:o.value,color:"error"}));return}b.show({message:n||"Admin updated successfully.",color:"success"}),x("saved",e??u)}catch(u){const e=u?.response,s=e?.data?.errors??null;if(e?.status===422&&s&&typeof s=="object"){const c={};for(const[g,I]of Object.entries(s))Array.isArray(I)?c[g]=I.map(N=>String(N)):I!=null&&(c[g]=[String(I)]);m.value=c;return}const n=ye(u);console.error("Failed to update admin:",n),o.value=n,b.show({message:n,color:"error"})}finally{_.value=!1}}}return Se(E),(p,u)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(w,["prevent"])},{default:t(()=>[$("div",Ga,[a(ge,null,{default:t(()=>[a(te,null,{default:t(()=>[a(U,{cols:"12",md:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:i.value.name,"onUpdate:modelValue":[u[0]||(u[0]=e=>i.value.name=e),u[1]||(u[1]=e=>V("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[k.required],"error-messages":z("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a(T,{modelValue:i.value.username,"onUpdate:modelValue":[u[2]||(u[2]=e=>i.value.username=e),C],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[k.required,k.noSpaces,k.lowercase,k.allowedChars,k.dotPlacement],"error-messages":z("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a($e,{modelValue:i.value.role_id,"onUpdate:modelValue":[u[3]||(u[3]=e=>i.value.role_id=e),u[4]||(u[4]=e=>V("role_id"))],items:d.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[k.required],"error-messages":z("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(U,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:t(()=>[a(K,{color:"primary",size:"large",variant:"tonal",loading:_.value,disabled:_.value,onClick:w},{default:t(()=>[a(L,{start:""},{default:t(()=>[...u[5]||(u[5]=[h("mdi-content-save-outline",-1)])]),_:1}),u[6]||(u[6]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),el={class:"px-6 pt-3"},al=G({__name:"AdminUpdateEmailTab",props:{admin:{}},emits:["saved"],setup(l,{emit:R}){const f=l,x=R,v=y(),d=y(""),o=y(!1),b=y({email:f.admin?.email??""}),_=y(""),i=y({}),m={required:V=>V?!0:"Required",email:V=>!V||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(V)?!0:"Invalid email"};function k(V){return i.value[V]??[]}function E(V){if(!i.value[V])return;const w={...i.value};delete w[V],i.value=w}function C(){E("email")}async function z(){d.value="",i.value={};const V=await v.value?.validate?.();if(!(V&&V.valid===!1)&&!(!V&&v.value?.validate&&!await v.value.validate())){o.value=!0;try{x("saved",{id:f.admin?.id,email:b.value.email,verification_code:_.value||void 0,tab:"email"})}finally{o.value=!1}}}return(V,w)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(z,["prevent"])},{default:t(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[h(j(d.value),1)]),_:1})):fe("",!0),$("div",el,[a(ge,null,{default:t(()=>[a(te,null,{default:t(()=>[a(U,{cols:"12",md:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:b.value.email,"onUpdate:modelValue":[w[0]||(w[0]=p=>b.value.email=p),w[1]||(w[1]=p=>E("email"))],label:"New Email",type:"email",variant:"outlined",density:"comfortable",rules:[m.required,m.email],"error-messages":k("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"7",class:"pb-0"},{default:t(()=>[a(T,{modelValue:_.value,"onUpdate:modelValue":[w[2]||(w[2]=p=>_.value=p),w[3]||(w[3]=p=>E("verification_code"))],label:"Verification Code",variant:"outlined",density:"comfortable",rules:[m.required],"error-messages":k("verification_code"),"prepend-inner-icon":"mdi-shield-key-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"5",class:"pb-0"},{default:t(()=>[a(K,{variant:"tonal",color:"primary",size:"large",disabled:o.value,onClick:C},{default:t(()=>[a(L,{start:""},{default:t(()=>[...w[4]||(w[4]=[h("mdi-email-send-outline",-1)])]),_:1}),w[5]||(w[5]=h(" Send Code ",-1))]),_:1},8,["disabled"])]),_:1}),a(U,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:t(()=>[a(K,{color:"primary",size:"large",variant:"tonal",loading:o.value,disabled:o.value,onClick:z},{default:t(()=>[a(L,{start:""},{default:t(()=>[...w[6]||(w[6]=[h("mdi-content-save-outline",-1)])]),_:1}),w[7]||(w[7]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),ll={class:"px-6 pt-3"},tl=G({__name:"AdminUpdatePasswordTab",props:{admin:{}},emits:["saved"],setup(l,{emit:R}){const f=l,x=R,v=y(),d=y(""),o=y(!1),b=ce(),_=y(!1),i=y(!1),m=y({password:"",confirm_password:""}),k=y({}),E={required:u=>u?!0:"Required",passwordMatch:()=>m.value.password===m.value.confirm_password?!0:"Passwords do not match"};function C(u){return k.value[u]??[]}function z(u){if(!k.value[u])return;const e={...k.value};delete e[u],k.value=e}function V(){_.value=!_.value}function w(){i.value=!i.value}async function p(){d.value="",k.value={};const u=await v.value?.validate?.();if(!(u&&u.valid===!1)&&!(!u&&v.value?.validate&&!await v.value.validate())){if(!f.admin?.id){d.value="Admin id is required.",b.show({message:d.value,color:"error"});return}o.value=!0;try{const e={id:f.admin.id,password:m.value.password,confirm_password:m.value.confirm_password},{data:s}=await Oa(e),n=s?.data?.updated??s?.updated??!0,c=s?.data?.message??s?.message??"",g=s?.data?.field??s?.field??"";if(n===!1){g?k.value={[g]:[c||"Invalid value."]}:(d.value=c||"Failed to update password.",b.show({message:d.value,color:"error"}));return}b.show({message:c||"Password updated successfully.",color:"success"}),x("saved",s??e)}catch(e){const s=e?.response,n=s?.data?.errors??null;if(s?.status===422&&n&&typeof n=="object"){const g={};for(const[I,N]of Object.entries(n))Array.isArray(N)?g[I]=N.map(H=>String(H)):N!=null&&(g[I]=[String(N)]);k.value=g;return}const c=ye(e);console.error("Failed to update password:",c),d.value=c,b.show({message:c,color:"error"})}finally{o.value=!1}}}return(u,e)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(p,["prevent"])},{default:t(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[h(j(d.value),1)]),_:1})):fe("",!0),$("div",ll,[a(ge,null,{default:t(()=>[a(te,null,{default:t(()=>[a(U,{cols:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:m.value.password,"onUpdate:modelValue":[e[0]||(e[0]=s=>m.value.password=s),e[1]||(e[1]=s=>z("password"))],label:"New Password",type:_.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[E.required],"error-messages":C("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":_.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":V},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(U,{cols:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:m.value.confirm_password,"onUpdate:modelValue":[e[2]||(e[2]=s=>m.value.confirm_password=s),e[3]||(e[3]=s=>z("confirm_password"))],label:"Confirm Password",type:i.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[E.required,E.passwordMatch],"error-messages":C("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":w},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(U,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:t(()=>[a(K,{color:"primary",size:"large",variant:"tonal",loading:o.value,disabled:o.value,onClick:p},{default:t(()=>[a(L,{start:""},{default:t(()=>[...e[4]||(e[4]=[h("mdi-content-save-outline",-1)])]),_:1}),e[5]||(e[5]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),nl=G({__name:"AdminUpdateModal",props:{admin:{}},emits:["close","saved"],setup(l,{emit:R}){const f=l,x=R,v=y("password"),d=[{value:"password",label:"Password",component:tl},{value:"basic",label:"Basic Info",component:Za},{value:"email",label:"Email",component:al}];function o(b){x("saved",b),x("close")}return(b,_)=>(q(),W(Ae,{class:"pt-4"},{default:t(()=>[a(qa,{modelValue:v.value,"onUpdate:modelValue":_[0]||(_[0]=i=>v.value=i),density:"compact",class:""},{default:t(()=>[(q(),Z(Y,null,Fe(d,i=>a(za,{key:i.value,value:i.value},{default:t(()=>[h(j(i.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(ze),a(Da,{modelValue:v.value,"onUpdate:modelValue":_[1]||(_[1]=i=>v.value=i)},{default:t(()=>[(q(),Z(Y,null,Fe(d,i=>a(Ma,{key:i.value,value:i.value,class:"pt-4"},{default:t(()=>[(q(),W(ha(i.component),{admin:f.admin,onSaved:o},null,40,["admin"]))]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}))}});function xe(l,R={},f={}){xa().open(l,R,f)}const sl=G({__name:"AdminActionButtons",props:{admin:{}},emits:["saved","deleted"],setup(l,{emit:R}){const f=l,x=R;function v(){xe(nl,{admin:f.admin},{title:"Update Admin",size:"md",onSaved:o=>{x("saved",o)}})}function d(){xe(Xa,{admin:f.admin},{title:"Confirm Admin Deletion",size:"sm",onSaved:o=>{x("deleted",o)}})}return(o,b)=>(q(),Z(Y,null,[a(K,{variant:"tonal",color:"primary",size:"x-small",icon:"",onClick:v},{default:t(()=>[a(L,null,{default:t(()=>[...b[0]||(b[0]=[h("mdi-cog",-1)])]),_:1})]),_:1}),a(K,{variant:"tonal",class:"ml-2",color:"error",size:"x-small",icon:"",onClick:d},{default:t(()=>[a(L,null,{default:t(()=>[...b[1]||(b[1]=[h("mdi-delete",-1)])]),_:1})]),_:1})],64))}}),ol={class:"w-100 d-flex align-center justify-space-between px-4 pt-2"},rl=G({__name:"AdminCreateModal",emits:["close","saved"],setup(l,{emit:R}){const f=R,x=y(),v=y([]),d=y(""),o=y({name:"",email:"",username:"",role_id:null,password:"",confirm_password:""}),b=y({}),_=y(!1),i=y(!1),m=y(!1),k=ce();async function E(){const{data:e}=await Pe(),s=Array.isArray(e)?e:e?.data??[];v.value=s.map(n=>({title:n?.name??"",value:n?.id??""})).filter(n=>n.title&&n.value!=="")}const C={required:e=>e?!0:"Required",email:e=>!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?!0:"Invalid email",noSpaces:e=>!e||!/\s/.test(e)?!0:"Username must not contain spaces",lowercase:e=>!e||e===e.toLowerCase()?!0:"Username must be lowercase",allowedChars:e=>!e||/^[a-z0-9_.-]+$/.test(e)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:e=>!e||!e.startsWith(".")&&!e.endsWith(".")?!0:"Dot cannot be the first or last character",passwordMatch:()=>o.value.password===o.value.confirm_password?!0:"Passwords do not match"};function z(e){typeof e=="string"&&(o.value.username=e.toLowerCase()),w("username")}function V(e){return b.value[e]??[]}function w(e){if(!b.value[e])return;const s={...b.value};delete s[e],b.value=s}function p(){o.value={name:"",email:"",username:"",role_id:null,password:"",confirm_password:""},d.value="",b.value={},i.value=!1,m.value=!1,x.value?.resetValidation?.()}async function u(){d.value="",b.value={};const e=await x.value?.validate?.();if(!(e&&e.valid===!1)&&!(!e&&x.value?.validate&&!await x.value.validate())){_.value=!0;try{const s={name:o.value.name,email:o.value.email,username:o.value.username,role_id:o.value.role_id,password:o.value.password,confirm_password:o.value.confirm_password},n=await Ba(s);k.show({message:n?.data?.message||"Admin created successfully.",color:"success"}),f("saved",n.data??s),f("close")}catch(s){const n=s?.response,c=n?.data?.errors??null;if(n?.status===422&&c&&typeof c=="object"){const I={};for(const[N,H]of Object.entries(c))Array.isArray(H)?I[N]=H.map(ee=>String(ee)):H!=null&&(I[N]=[String(H)]);b.value=I;return}const g=ye(s);d.value=g}finally{_.value=!1}}}return Se(E),(e,s)=>(q(),Z(Y,null,[a(Ae,{class:"py-6"},{default:t(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[h(j(d.value),1)]),_:1})):fe("",!0),a(ve,{ref_key:"formRef",ref:x,onSubmit:pe(u,["prevent"])},{default:t(()=>[a(te,null,{default:t(()=>[a(U,{cols:"12",md:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:o.value.name,"onUpdate:modelValue":[s[0]||(s[0]=n=>o.value.name=n),s[1]||(s[1]=n=>w("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[C.required],"error-messages":V("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"12",class:"pb-0"},{default:t(()=>[a(T,{modelValue:o.value.email,"onUpdate:modelValue":[s[2]||(s[2]=n=>o.value.email=n),s[3]||(s[3]=n=>w("email"))],label:"Email",type:"email",variant:"outlined",density:"comfortable",rules:[C.required,C.email],"error-messages":V("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a(T,{modelValue:o.value.username,"onUpdate:modelValue":[s[4]||(s[4]=n=>o.value.username=n),z],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[C.required,C.noSpaces,C.lowercase,C.allowedChars,C.dotPlacement],"error-messages":V("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a($e,{modelValue:o.value.role_id,"onUpdate:modelValue":[s[5]||(s[5]=n=>o.value.role_id=n),s[6]||(s[6]=n=>w("role_id"))],items:v.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[C.required],"error-messages":V("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a(T,{modelValue:o.value.password,"onUpdate:modelValue":[s[7]||(s[7]=n=>o.value.password=n),s[9]||(s[9]=n=>w("password"))],label:"Password",type:i.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[C.required],"error-messages":V("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":s[8]||(s[8]=n=>i.value=!i.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(U,{cols:"12",md:"6",class:"pb-0"},{default:t(()=>[a(T,{modelValue:o.value.confirm_password,"onUpdate:modelValue":[s[10]||(s[10]=n=>o.value.confirm_password=n),s[12]||(s[12]=n=>w("confirm_password"))],label:"Confirm Password",type:m.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[C.required,C.passwordMatch],"error-messages":V("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":m.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":s[11]||(s[11]=n=>m.value=!m.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(qe,{class:"pb-4"},{default:t(()=>[$("div",ol,[a(K,{icon:"",size:"small",variant:"tonal",title:"Reset form",color:"warning",disabled:_.value,onClick:p,"aria-label":"Reset form"},{default:t(()=>[a(L,null,{default:t(()=>[...s[13]||(s[13]=[h("mdi-refresh",-1)])]),_:1})]),_:1},8,["disabled"]),a(K,{color:"primary",variant:"tonal",class:"px-5",loading:_.value,disabled:_.value,onClick:u},{default:t(()=>[a(L,{start:""},{default:t(()=>[...s[14]||(s[14]=[h("mdi-content-save-outline",-1)])]),_:1}),s[15]||(s[15]=h(" submit ",-1))]),_:1},8,["loading","disabled"])])]),_:1})],64))}}),il=G({__name:"AdminCreateButton",emits:["saved"],setup(l,{emit:R}){const f=R;function x(){xe(rl,{},{title:"Add Admin",size:"md",onSaved:v=>{f("saved",v)}})}return(v,d)=>(q(),W(K,{color:"primary",variant:"flat",height:"40",onClick:x},{default:t(()=>[a(L,{start:""},{default:t(()=>[...d[0]||(d[0]=[h("mdi-account-plus",-1)])]),_:1}),d[1]||(d[1]=h(" Add Admin ",-1))]),_:1}))}}),ul={class:"text-medium-emphasis"},dl={class:"text-primary",style:{"font-size":"smaller"}},cl={class:"d-flex align-center gap-2"},ml={class:"ml-2 text-capitalize"},fl={key:1},vl={class:"d-flex align-center gap-2"},pl={class:"text-medium-emphasis"},gl={key:1,class:"text-medium-emphasis"},yl={class:"text-medium-emphasis",style:{"font-size":"0.8rem"}},wl=G({__name:"AdminListPage",setup(l){const R=[{title:"Name",key:"name",minWidth:"180",sortable:!1},{title:"Username",key:"username",minWidth:"160",sortable:!1},{title:"Role",key:"role",minWidth:"160",sortable:!1},{title:"Email",key:"email",minWidth:"220",sortable:!1},{title:"Created",key:"created_at",minWidth:"100",sortable:!1},{title:"Actions",key:"action",sortable:!1,minWidth:"100"}],f=y([]),x=y(0),v=y(!1),d=y({page:1,itemsPerPage:12,sortBy:[]}),o=y({query:"",role:null}),b=y([]),_=y(!1);async function i(){v.value=!0;try{const{data:n}=await La({page:d.value.page,per_page:d.value.itemsPerPage,search:o.value.query||void 0,role_id:o.value.role??void 0}),c=Array.isArray(n)?n:n?.data??[];f.value=c.map(g=>({...g})),x.value=n?.total??n?.meta?.total??c.length}finally{v.value=!1}}function m(n){d.value=n,_.value||(_.value=!0),i()}function k(){d.value.page=1,i()}function E(n){n||(d.value.page=1,i())}function C(n){n||(d.value.page=1,i())}function z(){d.value.page=1,i()}function V(){d.value.page=1,i()}function w(){d.value.page=1,i()}async function p(){const{data:n}=await Pe(),c=Array.isArray(n)?n:n?.data??[];b.value=c.map(g=>({title:g?.name??"",value:g?.id??""})).filter(g=>g.title&&g.value!=="")}async function u(n){try{await navigator.clipboard.writeText(n)}catch{}}function e(n){const c=n.trim().toLowerCase().replace(/\s+/g,"-"),g={"content-writer":"warning",administrator:"primary",manager:"success",csr:"orange"};return g[c]?g[c]:c.includes("admin")?"primary":c.includes("manager")?"success":c.includes("writer")?"warning":c.includes("csr")?"orange":"grey"}function s(n){const c=n.trim().toLowerCase().replace(/\s+/g,"-"),g={"content-writer":"mdi-pencil",administrator:"mdi-shield-crown-outline",manager:"mdi-briefcase-account-outline",csr:"mdi-headset"};return g[c]?g[c]:c.includes("admin")?"mdi-shield-account-outline":c.includes("manager")?"mdi-briefcase-account-outline":c.includes("writer")?"mdi-pencil":c.includes("csr")?"mdi-headset":"mdi-account-circle-outline"}return Se(()=>{_.value||(i(),_.value=!0),p()}),(n,c)=>(q(),W(ea,{headers:R,items:f.value,total:x.value,loading:v.value,"items-per-page":d.value.itemsPerPage,"onUpdate:options":m},{actions:t(()=>[a(ge,{fluid:""},{default:t(()=>[a(te,null,{default:t(()=>[a(U,{cols:"12",md:"3"},{default:t(()=>[a(T,{modelValue:o.value.query,"onUpdate:modelValue":[c[0]||(c[0]=g=>o.value.query=g),E],density:"compact",variant:"outlined",label:"Search",placeholder:"Search by name, email, or username","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue"])]),_:1}),a(U,{cols:"12",md:"3"},{default:t(()=>[a($e,{modelValue:o.value.role,"onUpdate:modelValue":[c[1]||(c[1]=g=>o.value.role=g),C],items:b.value,density:"compact",variant:"outlined",label:"Role","prepend-inner-icon":"mdi-shield-account-outline","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue","items"])]),_:1}),a(U,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[a(K,{color:"primary",variant:"tonal",height:"40",onClick:k},{default:t(()=>[a(L,{start:""},{default:t(()=>[...c[2]||(c[2]=[h("mdi-magnify",-1)])]),_:1}),c[3]||(c[3]=h(" Search ",-1))]),_:1})]),_:1}),a(U,{cols:"12",md:"4",class:"d-flex align-center justify-end"},{default:t(()=>[a(il,{onSaved:z})]),_:1})]),_:1}),a(te,null,{default:t(()=>[a(U,{cols:"12"},{default:t(()=>[$("div",ul,[$("span",dl," Total: "+j(x.value)+" Items found. ",1)])]),_:1})]),_:1})]),_:1})]),"item.name":t(({item:g})=>[$("div",cl,[a(Ce,{size:"28",color:"grey-lighten-3"},{default:t(()=>[a(L,{size:"18",color:"grey-darken-1"},{default:t(()=>[...c[4]||(c[4]=[h("mdi-account-circle",-1)])]),_:1})]),_:1}),$("span",ml,j(g.name??"-"),1)])]),"item.role":t(({item:g})=>[g.role?(q(),W(he,{key:0,size:"small",variant:"tonal",class:"text-uppercase font-weight-bold",color:e(g.role),label:""},{default:t(()=>[a(L,{start:"",size:"14"},{default:t(()=>[h(j(s(g.role)),1)]),_:2},1024),h(" "+j(g.role),1)]),_:2},1032,["color"])):(q(),Z("span",fl,"-"))]),"item.username":t(({item:g})=>[$("div",vl,[g.username?(q(),Z(Y,{key:0},[$("span",pl,j(`@${g.username}`),1),a(K,{icon:"",variant:"text",size:"x-small",onClick:I=>u(g.username)},{default:t(()=>[a(L,{size:"14"},{default:t(()=>[...c[5]||(c[5]=[h("mdi-content-copy",-1)])]),_:1})]),_:1},8,["onClick"])],64)):(q(),Z("span",gl,"@no.username"))])]),"item.action":t(({item:g})=>[a(sl,{admin:g,onSaved:V,onDeleted:w},null,8,["admin"])]),"item.created_at":t(({item:g})=>[$("span",yl,j(g.created_at??"-"),1)]),_:1},8,["items","total","loading","items-per-page"]))}}),hl=Ca(wl,[["__scopeId","data-v-00f08cf8"]]);export{hl as default};
