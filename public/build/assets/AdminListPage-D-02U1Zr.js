import{_ as Ze}from"./AppDataTable.vue_vue_type_script_setup_true_lang-B-xd4V_g.js";import{_ as re,v as ea,x as aa,ak as la,al as ta,am as na,y as we,an as sa,w as de,K as Se,ao as oa,B as ra,m as T,a,H as J,I as ua,N as ae,s as Q,r as g,ap as Ae,aq as Pe,ar as ia,q as da,P as ca,as as ma,z as va,g as M,e as L,at as fa,F as Y,au as pa,av as Ie,a1 as Re,aw as ga,h as $e,ax as ya,ay as wa,n as ba,az as _a,f as h,J as Va,d as G,aA as Ee,o as _e,p as F,T as W,Y as ce,X as me,b as s,k as le,l as I,V as j,j as ve,aB as Ve,t as K,W as ke,c as ee,a7 as Ue,a3 as ka,a2 as Fe,R as Ca,a5 as ha,a6 as xa}from"./main-Dm920kri.js";import{u as Sa,d as Aa,m as Pa,e as Ia,f as Ua,g as Ra,h as $a,i as Ea,V as be,j as Fa}from"./VDataTable-CQhQFdZr.js";import{V as qa,c as za,b as Ma,a as Da}from"./VTabs-C-v-I2ar.js";function Ce(){return re.get("/admin/rbac/roles")}function La(t){return re.get("/admin/admin-list",{params:t})}function Ba(t){return re.post("/admin/admin-create",t)}function Ta(t){return re.put(`/admin/admin-users/${t.id}/basic-info`,{name:t.name,username:t.username,role_id:t.role_id})}function Oa(t){return re.put(`/admin/admin-users/${t.id}/password`,{password:t.password,confirm_password:t.confirm_password})}function he(t){return t instanceof Error?t.message:"Unexpected error"}const Na=da({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Ia({filterKeys:["title"]}),...Pa(),...ca(ma({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VAutocomplete"),xe=ea()({name:"VAutocomplete",props:Na(),emits:{"update:focused":t=>!0,"update:search":t=>!0,"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,$){let{slots:f}=$;const{t:C}=aa(),p=g(),d=ae(!1),r=ae(!0),y=ae(!1),w=g(),c=g(),m=ae(-1),V=ae(null),{items:k,transformIn:N,transformOut:U}=la(t),{textColorClasses:b,textColorStyles:_}=ta(()=>p.value?.color),{InputIcon:v}=na(t),l=we(t,"search",""),e=we(t,"modelValue",[],o=>N(o===null?[null]:va(o)),o=>{const S=U(o);return t.multiple?S:S[0]??null}),n=Q(()=>typeof t.counterValue=="function"?t.counterValue(e.value):typeof t.counterValue=="number"?t.counterValue:e.value.length),i=sa(t),{filteredItems:u,getMatches:E}=Sa(t,k,()=>V.value??(r.value?"":l.value)),P=Q(()=>t.hideSelected&&V.value===null?u.value.filter(o=>!e.value.some(S=>S.value===o.value)):u.value),B=Va(()=>t.closableChips&&!i.isReadonly.value&&!i.isDisabled.value),X=Q(()=>!!(t.chips||f.chip)),te=Q(()=>X.value||!!f.selection),ze=Q(()=>e.value.map(o=>o.props.value)),ne=Q(()=>P.value.find(o=>o.type==="item"&&!o.props.disabled)),fe=Q(()=>(t.autoSelectFirst===!0||t.autoSelectFirst==="exact"&&l.value===ne.value?.title)&&P.value.length>0&&!r.value&&!y.value),ue=Q(()=>t.hideNoData&&!P.value.length||i.isReadonly.value||i.isDisabled.value),pe=we(t,"menu"),q=Q({get:()=>pe.value,set:o=>{pe.value&&!o&&w.value?.Î¨openChildren.size||o&&ue.value||(pe.value=o)}}),{menuId:Me,ariaExpanded:De,ariaControls:Le}=Aa(t,q),ge=g(),Be=Fa(ge,p);function Te(o){t.openOnClear&&(q.value=!0),l.value=""}function Oe(){ue.value||(q.value=!0)}function Ne(o){ue.value||(d.value&&(o.preventDefault(),o.stopPropagation()),q.value=!q.value)}function We(o){(Ae(o)||o.key==="Backspace")&&p.value?.focus()}function je(o){if(i.isReadonly.value)return;const S=p.value?.selectionStart,z=e.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(o.key)&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(q.value=!0),["Escape"].includes(o.key)&&(q.value=!1),fe.value&&["Enter","Tab"].includes(o.key)&&ne.value&&!e.value.some(A=>{let{value:D}=A;return D===ne.value.value})&&Z(ne.value),o.key==="ArrowDown"&&fe.value&&ge.value?.focus("next"),["Backspace","Delete"].includes(o.key)){if(!t.multiple&&te.value&&e.value.length>0&&!l.value)return Z(e.value[0],!1);if(~m.value){o.preventDefault();const A=m.value;Z(e.value[m.value],!1),m.value=A>=z-1?z-2:A}else o.key==="Backspace"&&!l.value&&(m.value=z-1);return}if(t.multiple)if(o.key==="ArrowLeft"){if(m.value<0&&S&&S>0)return;const A=m.value>-1?m.value-1:z-1;if(e.value[A])m.value=A;else{const D=l.value?.length??null;m.value=-1,p.value?.setSelectionRange(D,D)}}else if(o.key==="ArrowRight"){if(m.value<0)return;const A=m.value+1;e.value[A]?m.value=A:(m.value=-1,p.value?.setSelectionRange(0,0))}else~m.value&&Ae(o)&&(m.value=-1)}function Ke(o){if(Pe(p.value,":autofill")||Pe(p.value,":-webkit-autofill")){const S=k.value.find(z=>z.title===o.target.value);S&&Z(S)}}function He(){t.eager&&c.value?.calculateVisibleItems()}function Je(){d.value&&(r.value=!0,p.value?.focus()),V.value=null}function Qe(o){d.value=!0,setTimeout(()=>{y.value=!0})}function Xe(o){y.value=!1}function Ye(o){(o==null||o===""&&!t.multiple&&!te.value)&&(e.value=[])}const ye=ae(!1);function Z(o){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(t.multiple){const z=e.value.findIndex(D=>(t.valueComparator||ia)(D.value,o.value)),A=S??!~z;if(~z){const D=A?[...e.value,o]:[...e.value];D.splice(z,1),e.value=D}else A&&(e.value=[...e.value,o]);t.clearOnSelect&&(l.value="")}else{const z=S!==!1;e.value=z?[o]:[],V.value=r.value?"":l.value??"",l.value=z&&!te.value?o.title:"",Se(()=>{q.value=!1,r.value=!0})}}return de(d,(o,S)=>{o!==S&&(o?(ye.value=!0,l.value=t.multiple||te.value?"":String(e.value.at(-1)?.props.title??""),r.value=!0,Se(()=>ye.value=!1)):(!t.multiple&&l.value==null&&(e.value=[]),q.value=!1,!r.value&&l.value&&(V.value=l.value),l.value="",m.value=-1))}),de(l,o=>{!d.value||ye.value||(o&&(q.value=!0),r.value=!o)}),de(q,o=>{if(!t.hideSelected&&o&&e.value.length&&r.value){const S=P.value.findIndex(z=>e.value.some(A=>z.value===A.value));oa&&window.requestAnimationFrame(()=>{S>=0&&c.value?.scrollToIndex(S)})}o&&(V.value=null)}),de(k,(o,S)=>{q.value||d.value&&!S.length&&o.length&&(q.value=!0)}),ra(()=>{const o=!!(!t.hideNoData||P.value.length||f["prepend-item"]||f["append-item"]||f["no-data"]),S=e.value.length>0,z=T.filterProps(t);return a(T,J({ref:p},z,{modelValue:l.value,"onUpdate:modelValue":[A=>l.value=A,Ye],focused:d.value,"onUpdate:focused":A=>d.value=A,validationValue:e.externalValue,counterValue:n.value,dirty:S,onChange:Ke,class:["v-autocomplete",`v-autocomplete--${t.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":q.value,"v-autocomplete--chips":!!t.chips,"v-autocomplete--selection-slot":!!te.value,"v-autocomplete--selecting-index":m.value>-1},t.class],style:t.style,readonly:i.isReadonly.value,placeholder:S?void 0:t.placeholder,"onClick:clear":Te,"onMousedown:control":Oe,onKeydown:je,"aria-expanded":De.value,"aria-controls":Le.value}),{...f,default:A=>{let{id:D}=A;return M(Y,null,[a(Ua,J({id:Me.value,ref:w,modelValue:q.value,"onUpdate:modelValue":R=>q.value=R,activator:"parent",contentClass:"v-autocomplete__content",disabled:ue.value,eager:t.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:He,onAfterLeave:Je},t.menuProps),{default:()=>[o&&a(pa,J({ref:ge,filterable:!0,selected:ze.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:R=>R.preventDefault(),onKeydown:We,onFocusin:Qe,onFocusout:Xe,tabindex:"-1",selectable:!!P.value.length,"aria-live":"polite","aria-labelledby":`${D.value}-label`,"aria-multiselectable":t.multiple,color:t.itemColor??t.color},Be,t.listProps),{default:()=>[f["prepend-item"]?.(),!P.value.length&&!t.hideNoData&&(f["no-data"]?.()??a(Ie,{key:"no-data",title:C(t.noDataText)},null)),a(Ra,{ref:c,renderless:!0,items:P.value,itemKey:"value"},{default:R=>{let{item:x,index:H,itemRef:ie}=R;const se=J(x.props,{ref:ie,key:x.value,active:fe.value&&x===ne.value?!0:void 0,onClick:()=>Z(x,null),"aria-posinset":H+1,"aria-setsize":P.value.length});return x.type==="divider"?f.divider?.({props:x.raw,index:H})??a(Re,J(x.props,{key:`divider-${H}`}),null):x.type==="subheader"?f.subheader?.({props:x.raw,index:H})??a(ga,J(x.props,{key:`subheader-${H}`}),null):f.item?.({item:x,index:H,props:se})??a(Ie,J(se,{role:"option"}),{prepend:oe=>{let{isSelected:O}=oe;return M(Y,null,[t.multiple&&!t.hideSelected?a(Ea,{key:x.value,modelValue:O,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Ge=>Ge.preventDefault()},null):void 0,x.props.prependAvatar&&a($e,{image:x.props.prependAvatar},null),x.props.prependIcon&&a(L,{icon:x.props.prependIcon},null)])},title:()=>r.value?x.title:$a("v-autocomplete",x.title,E(x)?.title)})}}),f["append-item"]?.()]})]}),e.value.map((R,x)=>{function H(O){O.stopPropagation(),O.preventDefault(),Z(R,!1)}const ie=J(be.filterProps(R.props),{"onClick:close":H,onKeydown(O){O.key!=="Enter"&&O.key!==" "||(O.preventDefault(),O.stopPropagation(),H(O))},onMousedown(O){O.preventDefault(),O.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),se=X.value?!!f.chip:!!f.selection,oe=se?ya(X.value?f.chip({item:R,index:x,props:ie}):f.selection({item:R,index:x})):void 0;if(!(se&&!oe))return M("div",{key:R.value,class:ba(["v-autocomplete__selection",x===m.value&&["v-autocomplete__selection--selected",b.value]]),style:wa(x===m.value?_.value:{})},[X.value?f.chip?a(_a,{key:"chip-defaults",defaults:{VChip:{closable:B.value,size:"small",text:R.title}}},{default:()=>[oe]}):a(be,J({key:"chip",closable:B.value,size:"small",text:R.title,disabled:R.props.disabled},ie),null):oe??M("span",{class:"v-autocomplete__selection-text"},[R.title,t.multiple&&x<e.value.length-1&&M("span",{class:"v-autocomplete__selection-comma"},[h(",")])])])})])},"append-inner":function(){for(var A=arguments.length,D=new Array(A),R=0;R<A;R++)D[R]=arguments[R];return M(Y,null,[f["append-inner"]?.(...D),t.menuIcon?a(L,{class:"v-autocomplete__menu-icon",color:p.value?.fieldIconColor,icon:t.menuIcon,onMousedown:Ne,onClick:fa,"aria-hidden":!0,tabindex:"-1"},null):void 0,t.appendInnerIcon&&a(v,{key:"append-icon",name:"appendInner",color:D[0].iconColor.value},null)])}})}),ua({isFocused:d,isPristine:r,menu:q,search:l,filteredItems:u,select:Z},p)}}),Wa={class:"px-6 pt-3"},ja=G({__name:"AdminUpdateBasicTab",props:{admin:{}},emits:["saved"],setup(t,{emit:$}){const f=t,C=$,p=g(),d=g([]),r=g(""),y=Ee(),w=g(!1),c=g({name:f.admin?.name??"",username:f.admin?.username??"",role_id:f.admin?.role_id??null}),m=g({}),V={required:v=>v?!0:"Required",noSpaces:v=>!v||!/\s/.test(v)?!0:"Username must not contain spaces",lowercase:v=>!v||v===v.toLowerCase()?!0:"Username must be lowercase",allowedChars:v=>!v||/^[a-z0-9_.-]+$/.test(v)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:v=>!v||!v.startsWith(".")&&!v.endsWith(".")?!0:"Dot cannot be the first or last character"};async function k(){const{data:v}=await Ce(),l=Array.isArray(v)?v:v?.data??[];d.value=l.map(e=>({title:e?.name??"",value:e?.id??""})).filter(e=>e.title&&e.value!=="")}function N(v){typeof v=="string"&&(c.value.username=v.toLowerCase()),b("username")}function U(v){return m.value[v]??[]}function b(v){if(!m.value[v])return;const l={...m.value};delete l[v],m.value=l}async function _(){r.value="",m.value={};const v=await p.value?.validate?.();if(!(v&&v.valid===!1)&&!(!v&&p.value?.validate&&!await p.value.validate())){if(!f.admin?.id){r.value="Admin id is required.";return}w.value=!0;try{const l={id:f.admin.id,name:c.value.name,username:c.value.username,role_id:c.value.role_id},{data:e}=await Ta(l),n=e?.data?.updated??e?.updated??!0,i=e?.data?.message??e?.message??"",u=e?.data?.field??e?.field??"";if(n===!1){u?m.value={[u]:[i||"Invalid value."]}:(r.value=i||"Failed to update admin.",y.show({message:r.value,color:"error"}));return}y.show({message:i||"Admin updated successfully.",color:"success"}),C("saved",e??l)}catch(l){const e=l?.response,n=e?.data?.errors??null;if(e?.status===422&&n&&typeof n=="object"){const u={};for(const[E,P]of Object.entries(n))Array.isArray(P)?u[E]=P.map(B=>String(B)):P!=null&&(u[E]=[String(P)]);m.value=u;return}const i=he(l);console.error("Failed to update admin:",i),r.value=i,y.show({message:i,color:"error"})}finally{w.value=!1}}}return _e(k),(v,l)=>(F(),W(ce,{ref_key:"formRef",ref:p,onSubmit:me(_,["prevent"])},{default:s(()=>[M("div",Wa,[a(ve,null,{default:s(()=>[a(le,null,{default:s(()=>[a(I,{cols:"12",md:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:c.value.name,"onUpdate:modelValue":[l[0]||(l[0]=e=>c.value.name=e),l[1]||(l[1]=e=>b("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[V.required],"error-messages":U("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(T,{modelValue:c.value.username,"onUpdate:modelValue":[l[2]||(l[2]=e=>c.value.username=e),N],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[V.required,V.noSpaces,V.lowercase,V.allowedChars,V.dotPlacement],"error-messages":U("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(xe,{modelValue:c.value.role_id,"onUpdate:modelValue":[l[3]||(l[3]=e=>c.value.role_id=e),l[4]||(l[4]=e=>b("role_id"))],items:d.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[V.required],"error-messages":U("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(I,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:s(()=>[a(j,{color:"primary",size:"large",variant:"tonal",loading:w.value,disabled:w.value,onClick:_},{default:s(()=>[a(L,{start:""},{default:s(()=>[...l[5]||(l[5]=[h("mdi-content-save-outline",-1)])]),_:1}),l[6]||(l[6]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Ka={class:"px-6 pt-3"},Ha=G({__name:"AdminUpdateEmailTab",props:{admin:{}},emits:["saved"],setup(t,{emit:$}){const f=t,C=$,p=g(),d=g(""),r=g(!1),y=g({email:f.admin?.email??""}),w=g(""),c=g({}),m={required:b=>b?!0:"Required",email:b=>!b||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b)?!0:"Invalid email"};function V(b){return c.value[b]??[]}function k(b){if(!c.value[b])return;const _={...c.value};delete _[b],c.value=_}function N(){k("email")}async function U(){d.value="",c.value={};const b=await p.value?.validate?.();if(!(b&&b.valid===!1)&&!(!b&&p.value?.validate&&!await p.value.validate())){r.value=!0;try{C("saved",{id:f.admin?.id,email:y.value.email,verification_code:w.value||void 0,tab:"email"})}finally{r.value=!1}}}return(b,_)=>(F(),W(ce,{ref_key:"formRef",ref:p,onSubmit:me(U,["prevent"])},{default:s(()=>[d.value?(F(),W(Ve,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:s(()=>[h(K(d.value),1)]),_:1})):ke("",!0),M("div",Ka,[a(ve,null,{default:s(()=>[a(le,null,{default:s(()=>[a(I,{cols:"12",md:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:y.value.email,"onUpdate:modelValue":[_[0]||(_[0]=v=>y.value.email=v),_[1]||(_[1]=v=>k("email"))],label:"New Email",type:"email",variant:"outlined",density:"comfortable",rules:[m.required,m.email],"error-messages":V("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"7",class:"pb-0"},{default:s(()=>[a(T,{modelValue:w.value,"onUpdate:modelValue":[_[2]||(_[2]=v=>w.value=v),_[3]||(_[3]=v=>k("verification_code"))],label:"Verification Code",variant:"outlined",density:"comfortable",rules:[m.required],"error-messages":V("verification_code"),"prepend-inner-icon":"mdi-shield-key-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"5",class:"pb-0"},{default:s(()=>[a(j,{variant:"tonal",color:"primary",size:"large",disabled:r.value,onClick:N},{default:s(()=>[a(L,{start:""},{default:s(()=>[..._[4]||(_[4]=[h("mdi-email-send-outline",-1)])]),_:1}),_[5]||(_[5]=h(" Send Code ",-1))]),_:1},8,["disabled"])]),_:1}),a(I,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:s(()=>[a(j,{color:"primary",size:"large",variant:"tonal",loading:r.value,disabled:r.value,onClick:U},{default:s(()=>[a(L,{start:""},{default:s(()=>[..._[6]||(_[6]=[h("mdi-content-save-outline",-1)])]),_:1}),_[7]||(_[7]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Ja={class:"px-6 pt-3"},Qa=G({__name:"AdminUpdatePasswordTab",props:{admin:{}},emits:["saved"],setup(t,{emit:$}){const f=t,C=$,p=g(),d=g(""),r=g(!1),y=Ee(),w=g(!1),c=g(!1),m=g({password:"",confirm_password:""}),V=g({}),k={required:l=>l?!0:"Required",passwordMatch:()=>m.value.password===m.value.confirm_password?!0:"Passwords do not match"};function N(l){return V.value[l]??[]}function U(l){if(!V.value[l])return;const e={...V.value};delete e[l],V.value=e}function b(){w.value=!w.value}function _(){c.value=!c.value}async function v(){d.value="",V.value={};const l=await p.value?.validate?.();if(!(l&&l.valid===!1)&&!(!l&&p.value?.validate&&!await p.value.validate())){if(!f.admin?.id){d.value="Admin id is required.",y.show({message:d.value,color:"error"});return}r.value=!0;try{const e={id:f.admin.id,password:m.value.password,confirm_password:m.value.confirm_password},{data:n}=await Oa(e),i=n?.data?.updated??n?.updated??!0,u=n?.data?.message??n?.message??"",E=n?.data?.field??n?.field??"";if(i===!1){E?V.value={[E]:[u||"Invalid value."]}:(d.value=u||"Failed to update password.",y.show({message:d.value,color:"error"}));return}y.show({message:u||"Password updated successfully.",color:"success"}),C("saved",n??e)}catch(e){const n=e?.response,i=n?.data?.errors??null;if(n?.status===422&&i&&typeof i=="object"){const E={};for(const[P,B]of Object.entries(i))Array.isArray(B)?E[P]=B.map(X=>String(X)):B!=null&&(E[P]=[String(B)]);V.value=E;return}const u=he(e);console.error("Failed to update password:",u),d.value=u,y.show({message:u,color:"error"})}finally{r.value=!1}}}return(l,e)=>(F(),W(ce,{ref_key:"formRef",ref:p,onSubmit:me(v,["prevent"])},{default:s(()=>[d.value?(F(),W(Ve,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:s(()=>[h(K(d.value),1)]),_:1})):ke("",!0),M("div",Ja,[a(ve,null,{default:s(()=>[a(le,null,{default:s(()=>[a(I,{cols:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:m.value.password,"onUpdate:modelValue":[e[0]||(e[0]=n=>m.value.password=n),e[1]||(e[1]=n=>U("password"))],label:"New Password",type:w.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[k.required],"error-messages":N("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":w.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":b},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(I,{cols:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:m.value.confirm_password,"onUpdate:modelValue":[e[2]||(e[2]=n=>m.value.confirm_password=n),e[3]||(e[3]=n=>U("confirm_password"))],label:"Confirm Password",type:c.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[k.required,k.passwordMatch],"error-messages":N("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":c.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":_},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(I,{cols:"12",class:"d-flex justify-space-around pt-4"},{default:s(()=>[a(j,{color:"primary",size:"large",variant:"tonal",loading:r.value,disabled:r.value,onClick:v},{default:s(()=>[a(L,{start:""},{default:s(()=>[...e[4]||(e[4]=[h("mdi-content-save-outline",-1)])]),_:1}),e[5]||(e[5]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Xa=G({__name:"AdminUpdateModal",props:{admin:{}},emits:["close","saved"],setup(t,{emit:$}){const f=t,C=$,p=g("password"),d=[{value:"password",label:"Password",component:Qa},{value:"basic",label:"Basic Info",component:ja},{value:"email",label:"Email",component:Ha}];function r(y){C("saved",y),C("close")}return(y,w)=>(F(),W(Fe,{class:"pt-4"},{default:s(()=>[a(qa,{modelValue:p.value,"onUpdate:modelValue":w[0]||(w[0]=c=>p.value=c),density:"compact",class:""},{default:s(()=>[(F(),ee(Y,null,Ue(d,c=>a(za,{key:c.value,value:c.value},{default:s(()=>[h(K(c.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(Re),a(Ma,{modelValue:p.value,"onUpdate:modelValue":w[1]||(w[1]=c=>p.value=c)},{default:s(()=>[(F(),ee(Y,null,Ue(d,c=>a(Da,{key:c.value,value:c.value,class:"pt-4"},{default:s(()=>[(F(),W(ka(c.component),{admin:f.admin,onSaved:r},null,40,["admin"]))]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}))}});function qe(t,$={},f={}){Ca().open(t,$,f)}const Ya=G({__name:"AdminActionButtons",props:{admin:{}},emits:["saved","delete"],setup(t,{emit:$}){const f=t,C=$;function p(){qe(Xa,{admin:f.admin},{title:"Update Admin",size:"md",onSaved:r=>{C("saved",r)}})}function d(){C("delete",f.admin)}return(r,y)=>(F(),ee(Y,null,[a(j,{variant:"tonal",color:"primary",size:"x-small",icon:"",onClick:p},{default:s(()=>[a(L,null,{default:s(()=>[...y[0]||(y[0]=[h("mdi-cog",-1)])]),_:1})]),_:1}),a(j,{variant:"tonal",class:"ml-2",color:"error",size:"x-small",icon:"",onClick:d},{default:s(()=>[a(L,null,{default:s(()=>[...y[1]||(y[1]=[h("mdi-delete",-1)])]),_:1})]),_:1})],64))}}),Ga={class:"w-100 d-flex align-center justify-space-between px-4 pt-2"},Za=G({__name:"AdminCreateModal",emits:["close","saved"],setup(t,{emit:$}){const f=$,C=g(),p=g([]),d=g(""),r=g({name:"",email:"",username:"",role_id:null,password:"",confirm_password:""}),y=g({}),w=g(!1),c=g(!1),m=g(!1);async function V(){const{data:l}=await Ce(),e=Array.isArray(l)?l:l?.data??[];p.value=e.map(n=>({title:n?.name??"",value:n?.id??""})).filter(n=>n.title&&n.value!=="")}const k={required:l=>l?!0:"Required",email:l=>!l||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)?!0:"Invalid email",noSpaces:l=>!l||!/\s/.test(l)?!0:"Username must not contain spaces",lowercase:l=>!l||l===l.toLowerCase()?!0:"Username must be lowercase",allowedChars:l=>!l||/^[a-z0-9_.-]+$/.test(l)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:l=>!l||!l.startsWith(".")&&!l.endsWith(".")?!0:"Dot cannot be the first or last character",passwordMatch:()=>r.value.password===r.value.confirm_password?!0:"Passwords do not match"};function N(l){typeof l=="string"&&(r.value.username=l.toLowerCase()),b("username")}function U(l){return y.value[l]??[]}function b(l){if(!y.value[l])return;const e={...y.value};delete e[l],y.value=e}function _(){r.value={name:"",email:"",username:"",role_id:null,password:"",confirm_password:""},d.value="",y.value={},c.value=!1,m.value=!1,C.value?.resetValidation?.()}async function v(){d.value="",y.value={};const l=await C.value?.validate?.();if(!(l&&l.valid===!1)&&!(!l&&C.value?.validate&&!await C.value.validate())){w.value=!0;try{const e={name:r.value.name,email:r.value.email,username:r.value.username,role_id:r.value.role_id,password:r.value.password,confirm_password:r.value.confirm_password},{data:n}=await Ba(e),i=n?.data?.created??n?.created??!1,u=n?.data?.message??n?.message??"",E=n?.data?.field??n?.field??"";if(!i){if(E)y.value={[E]:[u||"Invalid value."]};else{const P=u.toLowerCase();P.includes("email")?y.value={email:[u]}:P.includes("username")?y.value={username:[u]}:d.value=u||"Failed to create admin."}return}f("saved",n??e),f("close")}catch(e){const n=e?.response,i=n?.data?.errors??null;if(n?.status===422&&i&&typeof i=="object"){const E={};for(const[P,B]of Object.entries(i))Array.isArray(B)?E[P]=B.map(X=>String(X)):B!=null&&(E[P]=[String(B)]);y.value=E;return}const u=he(e);console.error("Failed to create admin:",u),d.value=u}finally{w.value=!1}}}return _e(V),(l,e)=>(F(),ee(Y,null,[a(Fe,{class:"py-6"},{default:s(()=>[d.value?(F(),W(Ve,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:s(()=>[h(K(d.value),1)]),_:1})):ke("",!0),a(ce,{ref_key:"formRef",ref:C,onSubmit:me(v,["prevent"])},{default:s(()=>[a(le,null,{default:s(()=>[a(I,{cols:"12",md:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:r.value.name,"onUpdate:modelValue":[e[0]||(e[0]=n=>r.value.name=n),e[1]||(e[1]=n=>b("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[k.required],"error-messages":U("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"12",class:"pb-0"},{default:s(()=>[a(T,{modelValue:r.value.email,"onUpdate:modelValue":[e[2]||(e[2]=n=>r.value.email=n),e[3]||(e[3]=n=>b("email"))],label:"Email",type:"email",variant:"outlined",density:"comfortable",rules:[k.required,k.email],"error-messages":U("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(T,{modelValue:r.value.username,"onUpdate:modelValue":[e[4]||(e[4]=n=>r.value.username=n),N],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[k.required,k.noSpaces,k.lowercase,k.allowedChars,k.dotPlacement],"error-messages":U("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(xe,{modelValue:r.value.role_id,"onUpdate:modelValue":[e[5]||(e[5]=n=>r.value.role_id=n),e[6]||(e[6]=n=>b("role_id"))],items:p.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[k.required],"error-messages":U("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(T,{modelValue:r.value.password,"onUpdate:modelValue":[e[7]||(e[7]=n=>r.value.password=n),e[9]||(e[9]=n=>b("password"))],label:"Password",type:c.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[k.required],"error-messages":U("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":c.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[8]||(e[8]=n=>c.value=!c.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a(I,{cols:"12",md:"6",class:"pb-0"},{default:s(()=>[a(T,{modelValue:r.value.confirm_password,"onUpdate:modelValue":[e[10]||(e[10]=n=>r.value.confirm_password=n),e[12]||(e[12]=n=>b("confirm_password"))],label:"Confirm Password",type:m.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[k.required,k.passwordMatch],"error-messages":U("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":m.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[11]||(e[11]=n=>m.value=!m.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(ha,{class:"pb-4"},{default:s(()=>[M("div",Ga,[a(j,{icon:"",size:"small",variant:"tonal",title:"Reset form",color:"warning",disabled:w.value,onClick:_,"aria-label":"Reset form"},{default:s(()=>[a(L,null,{default:s(()=>[...e[13]||(e[13]=[h("mdi-refresh",-1)])]),_:1})]),_:1},8,["disabled"]),a(j,{color:"primary",variant:"tonal",class:"px-5",loading:w.value,disabled:w.value,onClick:v},{default:s(()=>[a(L,{start:""},{default:s(()=>[...e[14]||(e[14]=[h("mdi-content-save-outline",-1)])]),_:1}),e[15]||(e[15]=h(" submit ",-1))]),_:1},8,["loading","disabled"])])]),_:1})],64))}}),el=G({__name:"AdminCreateButton",emits:["saved"],setup(t,{emit:$}){const f=$;function C(){qe(Za,{},{title:"Add Admin",size:"md",onSaved:p=>{f("saved",p)}})}return(p,d)=>(F(),W(j,{color:"primary",variant:"flat",height:"40",onClick:C},{default:s(()=>[a(L,{start:""},{default:s(()=>[...d[0]||(d[0]=[h("mdi-account-plus",-1)])]),_:1}),d[1]||(d[1]=h(" Add Admin ",-1))]),_:1}))}}),al={class:"text-medium-emphasis"},ll={class:"text-primary",style:{"font-size":"smaller"}},tl={class:"d-flex align-center gap-2"},nl={class:"ml-2 text-capitalize"},sl={key:1},ol={class:"d-flex align-center gap-2"},rl={class:"text-medium-emphasis"},ul={key:1,class:"text-medium-emphasis"},il={class:"text-medium-emphasis",style:{"font-size":"0.8rem"}},dl=G({__name:"AdminListPage",setup(t){const $=[{title:"Name",key:"name",minWidth:"180",sortable:!1},{title:"Username",key:"username",minWidth:"160",sortable:!1},{title:"Role",key:"role",minWidth:"160",sortable:!1},{title:"Email",key:"email",minWidth:"220",sortable:!1},{title:"Created",key:"created_at",minWidth:"100",sortable:!1},{title:"Actions",key:"action",sortable:!1,minWidth:"100"}],f=g([]),C=g(0),p=g(!1),d=g({page:1,itemsPerPage:12,sortBy:[]}),r=g({query:"",role:null}),y=g([]),w=g(!1);async function c(){p.value=!0;try{const{data:n}=await La({page:d.value.page,per_page:d.value.itemsPerPage,search:r.value.query||void 0,role_id:r.value.role??void 0}),i=Array.isArray(n)?n:n?.data??[];f.value=i.map(u=>({...u})),C.value=n?.total??n?.meta?.total??i.length}finally{p.value=!1}}function m(n){d.value=n,w.value||(w.value=!0),c()}function V(){d.value.page=1,c()}function k(n){n||(d.value.page=1,c())}function N(n){n||(d.value.page=1,c())}function U(){d.value.page=1,c()}function b(){d.value.page=1,c()}async function _(){const{data:n}=await Ce(),i=Array.isArray(n)?n:n?.data??[];y.value=i.map(u=>({title:u?.name??"",value:u?.id??""})).filter(u=>u.title&&u.value!=="")}async function v(n){try{await navigator.clipboard.writeText(n)}catch{}}function l(n){const i=n.trim().toLowerCase().replace(/\s+/g,"-"),u={"content-writer":"warning",administrator:"primary",manager:"success",csr:"orange"};return u[i]?u[i]:i.includes("admin")?"primary":i.includes("manager")?"success":i.includes("writer")?"warning":i.includes("csr")?"orange":"grey"}function e(n){const i=n.trim().toLowerCase().replace(/\s+/g,"-"),u={"content-writer":"mdi-pencil",administrator:"mdi-shield-crown-outline",manager:"mdi-briefcase-account-outline",csr:"mdi-headset"};return u[i]?u[i]:i.includes("admin")?"mdi-shield-account-outline":i.includes("manager")?"mdi-briefcase-account-outline":i.includes("writer")?"mdi-pencil":i.includes("csr")?"mdi-headset":"mdi-account-circle-outline"}return _e(()=>{w.value||(c(),w.value=!0),_()}),(n,i)=>(F(),W(Ze,{headers:$,items:f.value,total:C.value,loading:p.value,"items-per-page":d.value.itemsPerPage,"onUpdate:options":m},{actions:s(()=>[a(ve,{fluid:""},{default:s(()=>[a(le,null,{default:s(()=>[a(I,{cols:"12",md:"3"},{default:s(()=>[a(T,{modelValue:r.value.query,"onUpdate:modelValue":[i[0]||(i[0]=u=>r.value.query=u),k],density:"compact",variant:"outlined",label:"Search",placeholder:"Search by name, email, or username","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue"])]),_:1}),a(I,{cols:"12",md:"3"},{default:s(()=>[a(xe,{modelValue:r.value.role,"onUpdate:modelValue":[i[1]||(i[1]=u=>r.value.role=u),N],items:y.value,density:"compact",variant:"outlined",label:"Role","prepend-inner-icon":"mdi-shield-account-outline","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue","items"])]),_:1}),a(I,{cols:"12",md:"2",class:"d-flex align-center"},{default:s(()=>[a(j,{color:"primary",variant:"tonal",height:"40",onClick:V},{default:s(()=>[a(L,{start:""},{default:s(()=>[...i[2]||(i[2]=[h("mdi-magnify",-1)])]),_:1}),i[3]||(i[3]=h(" Search ",-1))]),_:1})]),_:1}),a(I,{cols:"12",md:"4",class:"d-flex align-center justify-end"},{default:s(()=>[a(el,{onSaved:U})]),_:1})]),_:1}),a(le,null,{default:s(()=>[a(I,{cols:"12"},{default:s(()=>[M("div",al,[M("span",ll," Total: "+K(C.value)+" Items found. ",1)])]),_:1})]),_:1})]),_:1})]),"item.name":s(({item:u})=>[M("div",tl,[a($e,{size:"28",color:"grey-lighten-3"},{default:s(()=>[a(L,{size:"18",color:"grey-darken-1"},{default:s(()=>[...i[4]||(i[4]=[h("mdi-account-circle",-1)])]),_:1})]),_:1}),M("span",nl,K(u.name??"-"),1)])]),"item.role":s(({item:u})=>[u.role?(F(),W(be,{key:0,size:"small",variant:"tonal",class:"text-uppercase font-weight-bold",color:l(u.role),label:""},{default:s(()=>[a(L,{start:"",size:"14"},{default:s(()=>[h(K(e(u.role)),1)]),_:2},1024),h(" "+K(u.role),1)]),_:2},1032,["color"])):(F(),ee("span",sl,"-"))]),"item.username":s(({item:u})=>[M("div",ol,[u.username?(F(),ee(Y,{key:0},[M("span",rl,K(`@${u.username}`),1),a(j,{icon:"",variant:"text",size:"x-small",onClick:E=>v(u.username)},{default:s(()=>[a(L,{size:"14"},{default:s(()=>[...i[5]||(i[5]=[h("mdi-content-copy",-1)])]),_:1})]),_:1},8,["onClick"])],64)):(F(),ee("span",ul,"@no.username"))])]),"item.action":s(({item:u})=>[a(Ya,{admin:u,onSaved:b},null,8,["admin"])]),"item.created_at":s(({item:u})=>[M("span",il,K(u.created_at??"-"),1)]),_:1},8,["items","total","loading","items-per-page"]))}}),pl=xa(dl,[["__scopeId","data-v-46e3c8bd"]]);export{pl as default};
