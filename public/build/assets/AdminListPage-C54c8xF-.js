import{_ as ea}from"./AppDataTable.vue_vue_type_script_setup_true_lang-BrHup8An.js";import{_ as ne,d as Y,ak as ce,p as q,c as le,a,b as n,T as W,al as me,f as h,t as j,W as fe,g as P,h as Ce,e as M,a2 as Ae,V as H,a5 as qe,F as G,r as g,v as aa,x as la,am as ta,an as na,ao as sa,y as ke,ap as oa,w as de,K as Ie,aq as ra,B as ia,m as B,H as Q,I as ua,N as ae,s as X,ar as Re,as as Ue,at as da,q as ca,P as ma,au as fa,z as va,av as pa,aw as ga,ax as Ee,a1 as De,ay as ya,az as wa,aA as ba,n as _a,aB as Va,J as ka,o as Se,Y as ve,X as pe,k as te,l as $,j as ge,a7 as Fe,a3 as ha,R as xa,a6 as Ca}from"./main-Mk75_2Bb.js";import{u as Aa,d as Sa,m as Pa,e as $a,f as Ia,g as Ra,h as Ua,i as Ea,V as he,j as Fa}from"./VDataTable-CXZ8Jdy-.js";import{V as qa,c as Da,b as za,a as Ma}from"./VTabs-B5u0b5bI.js";function La(l){return ne.get("/admin/admin-list",{params:l})}function Ba(l){return ne.post("/admin/admin-create",l)}function Ta(l){return ne.put(`/admin/admin-users/${l.id}/basic-info`,{name:l.name,username:l.username,role_id:l.role_id})}function Oa(l){return ne.put(`/admin/admin-users/${l.id}/password`,{password:l.password,confirm_password:l.confirm_password})}function ja(l){return ne.delete(`/admin/admin-users/${l}/delete`)}function ye(l){return l instanceof Error?l.message:"Unexpected error"}const Na={class:"mt-3 d-flex align-center justify-space-around py-6"},Wa={style:{width:"max-content"},class:"d-flex align-center"},Ka={class:"ml-3"},Ha={class:"font-weight-medium text-capitalize"},Ja={class:"text-medium-emphasis"},Qa={class:"w-100 d-flex align-center justify-space-around"},Xa=Y({__name:"AdminDeleteModal",props:{admin:{}},emits:["close","saved"],setup(l,{emit:I}){const f=l,k=I,v=g(!1),d=g(""),o=ce();async function w(){if(d.value="",!f.admin?.id){d.value="Admin id is required.";return}v.value=!0;try{await ja(f.admin.id),o.show({message:"Admin deleted successfully.",color:"success"}),k("saved",{id:f.admin.id}),k("close")}catch(b){const i=b?.response,c=i?.data?.errors??null;if(i?.status===422&&c&&typeof c=="object"){const R={};for(const[F,_]of Object.entries(c))Array.isArray(_)?R[F]=_.map(y=>String(y)):_!=null&&(R[F]=[String(_)]);const x=R.id?.[0]??"Failed to delete admin.";d.value=x,o.show({message:x,color:"error"});return}const V=ye(b);d.value=V,o.show({message:V,color:"error"})}finally{v.value=!1}}return(b,i)=>(q(),le(G,null,[a(Ae,{class:"py-6"},{default:n(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:n(()=>[h(j(d.value),1)]),_:1})):fe("",!0),P("div",Na,[P("div",Wa,[a(Ce,{size:"40",color:"grey-lighten-3"},{default:n(()=>[a(M,{size:"22",color:"grey-darken-1"},{default:n(()=>[...i[0]||(i[0]=[h("mdi-account-circle",-1)])]),_:1})]),_:1}),P("div",Ka,[P("div",Ha,j(l.admin.name??"-"),1),P("div",Ja,"@"+j(l.admin.username??l.admin.email),1)])])])]),_:1}),a(qe,{class:"pb-4"},{default:n(()=>[P("div",Qa,[a(H,{color:"error",variant:"tonal",loading:v.value,disabled:v.value,onClick:w},{default:n(()=>[a(M,{start:""},{default:n(()=>[...i[1]||(i[1]=[h("mdi-delete",-1)])]),_:1}),i[2]||(i[2]=h(" Delete ",-1))]),_:1},8,["loading","disabled"])])]),_:1})],64))}});function Pe(){return ne.get("/admin/rbac/roles")}const Ya=ca({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...$a({filterKeys:["title"]}),...Pa(),...ma(fa({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VAutocomplete"),$e=aa()({name:"VAutocomplete",props:Ya(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,I){let{slots:f}=I;const{t:k}=la(),v=g(),d=ae(!1),o=ae(!0),w=ae(!1),b=g(),i=g(),c=ae(-1),V=ae(null),{items:R,transformIn:x,transformOut:F}=ta(l),{textColorClasses:_,textColorStyles:y}=na(()=>v.value?.color),{InputIcon:p}=sa(l),u=ke(l,"search",""),e=ke(l,"modelValue",[],r=>x(r===null?[null]:va(r)),r=>{const A=F(r);return l.multiple?A:A[0]??null}),t=X(()=>typeof l.counterValue=="function"?l.counterValue(e.value):typeof l.counterValue=="number"?l.counterValue:e.value.length),s=oa(l),{filteredItems:m,getMatches:T}=Aa(l,R,()=>V.value??(o.value?"":u.value)),U=X(()=>l.hideSelected&&V.value===null?m.value.filter(r=>!e.value.some(A=>A.value===r.value)):m.value),N=ka(()=>l.closableChips&&!s.isReadonly.value&&!s.isDisabled.value),K=X(()=>!!(l.chips||f.chip)),Z=X(()=>K.value||!!f.selection),ze=X(()=>e.value.map(r=>r.props.value)),se=X(()=>U.value.find(r=>r.type==="item"&&!r.props.disabled)),we=X(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&u.value===se.value?.title)&&U.value.length>0&&!o.value&&!w.value),ie=X(()=>l.hideNoData&&!U.value.length||s.isReadonly.value||s.isDisabled.value),be=ke(l,"menu"),D=X({get:()=>be.value,set:r=>{be.value&&!r&&b.value?.Î¨openChildren.size||r&&ie.value||(be.value=r)}}),{menuId:Me,ariaExpanded:Le,ariaControls:Be}=Sa(l,D),_e=g(),Te=Fa(_e,v);function Oe(r){l.openOnClear&&(D.value=!0),u.value=""}function je(){ie.value||(D.value=!0)}function Ne(r){ie.value||(d.value&&(r.preventDefault(),r.stopPropagation()),D.value=!D.value)}function We(r){(Re(r)||r.key==="Backspace")&&v.value?.focus()}function Ke(r){if(s.isReadonly.value)return;const A=v.value?.selectionStart,z=e.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(r.key)&&r.preventDefault(),["Enter","ArrowDown"].includes(r.key)&&(D.value=!0),["Escape"].includes(r.key)&&(D.value=!1),we.value&&["Enter","Tab"].includes(r.key)&&se.value&&!e.value.some(S=>{let{value:L}=S;return L===se.value.value})&&ee(se.value),r.key==="ArrowDown"&&we.value&&_e.value?.focus("next"),["Backspace","Delete"].includes(r.key)){if(!l.multiple&&Z.value&&e.value.length>0&&!u.value)return ee(e.value[0],!1);if(~c.value){r.preventDefault();const S=c.value;ee(e.value[c.value],!1),c.value=S>=z-1?z-2:S}else r.key==="Backspace"&&!u.value&&(c.value=z-1);return}if(l.multiple)if(r.key==="ArrowLeft"){if(c.value<0&&A&&A>0)return;const S=c.value>-1?c.value-1:z-1;if(e.value[S])c.value=S;else{const L=u.value?.length??null;c.value=-1,v.value?.setSelectionRange(L,L)}}else if(r.key==="ArrowRight"){if(c.value<0)return;const S=c.value+1;e.value[S]?c.value=S:(c.value=-1,v.value?.setSelectionRange(0,0))}else~c.value&&Re(r)&&(c.value=-1)}function He(r){if(Ue(v.value,":autofill")||Ue(v.value,":-webkit-autofill")){const A=R.value.find(z=>z.title===r.target.value);A&&ee(A)}}function Je(){l.eager&&i.value?.calculateVisibleItems()}function Qe(){d.value&&(o.value=!0,v.value?.focus()),V.value=null}function Xe(r){d.value=!0,setTimeout(()=>{w.value=!0})}function Ye(r){w.value=!1}function Ge(r){(r==null||r===""&&!l.multiple&&!Z.value)&&(e.value=[])}const Ve=ae(!1);function ee(r){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!r||r.props.disabled))if(l.multiple){const z=e.value.findIndex(L=>(l.valueComparator||da)(L.value,r.value)),S=A??!~z;if(~z){const L=S?[...e.value,r]:[...e.value];L.splice(z,1),e.value=L}else S&&(e.value=[...e.value,r]);l.clearOnSelect&&(u.value="")}else{const z=A!==!1;e.value=z?[r]:[],V.value=o.value?"":u.value??"",u.value=z&&!Z.value?r.title:"",Ie(()=>{D.value=!1,o.value=!0})}}return de(d,(r,A)=>{r!==A&&(r?(Ve.value=!0,u.value=l.multiple||Z.value?"":String(e.value.at(-1)?.props.title??""),o.value=!0,Ie(()=>Ve.value=!1)):(!l.multiple&&u.value==null&&(e.value=[]),D.value=!1,!o.value&&u.value&&(V.value=u.value),u.value="",c.value=-1))}),de(u,r=>{!d.value||Ve.value||(r&&(D.value=!0),o.value=!r)}),de(D,r=>{if(!l.hideSelected&&r&&e.value.length&&o.value){const A=U.value.findIndex(z=>e.value.some(S=>z.value===S.value));ra&&window.requestAnimationFrame(()=>{A>=0&&i.value?.scrollToIndex(A)})}r&&(V.value=null)}),de(R,(r,A)=>{D.value||d.value&&!A.length&&r.length&&(D.value=!0)}),ia(()=>{const r=!!(!l.hideNoData||U.value.length||f["prepend-item"]||f["append-item"]||f["no-data"]),A=e.value.length>0,z=B.filterProps(l);return a(B,Q({ref:v},z,{modelValue:u.value,"onUpdate:modelValue":[S=>u.value=S,Ge],focused:d.value,"onUpdate:focused":S=>d.value=S,validationValue:e.externalValue,counterValue:t.value,dirty:A,onChange:He,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":D.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!Z.value,"v-autocomplete--selecting-index":c.value>-1},l.class],style:l.style,readonly:s.isReadonly.value,placeholder:A?void 0:l.placeholder,"onClick:clear":Oe,"onMousedown:control":je,onKeydown:Ke,"aria-expanded":Le.value,"aria-controls":Be.value}),{...f,default:S=>{let{id:L}=S;return P(G,null,[a(Ia,Q({id:Me.value,ref:b,modelValue:D.value,"onUpdate:modelValue":E=>D.value=E,activator:"parent",contentClass:"v-autocomplete__content",disabled:ie.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:Je,onAfterLeave:Qe},l.menuProps),{default:()=>[r&&a(ga,Q({ref:_e,filterable:!0,selected:ze.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:E=>E.preventDefault(),onKeydown:We,onFocusin:Xe,onFocusout:Ye,tabindex:"-1",selectable:!!U.value.length,"aria-live":"polite","aria-labelledby":`${L.value}-label`,"aria-multiselectable":l.multiple,color:l.itemColor??l.color},Te,l.listProps),{default:()=>[f["prepend-item"]?.(),!U.value.length&&!l.hideNoData&&(f["no-data"]?.()??a(Ee,{key:"no-data",title:k(l.noDataText)},null)),a(Ra,{ref:i,renderless:!0,items:U.value,itemKey:"value"},{default:E=>{let{item:C,index:J,itemRef:ue}=E;const oe=Q(C.props,{ref:ue,key:C.value,active:we.value&&C===se.value?!0:void 0,onClick:()=>ee(C,null),"aria-posinset":J+1,"aria-setsize":U.value.length});return C.type==="divider"?f.divider?.({props:C.raw,index:J})??a(De,Q(C.props,{key:`divider-${J}`}),null):C.type==="subheader"?f.subheader?.({props:C.raw,index:J})??a(ya,Q(C.props,{key:`subheader-${J}`}),null):f.item?.({item:C,index:J,props:oe})??a(Ee,Q(oe,{role:"option"}),{prepend:re=>{let{isSelected:O}=re;return P(G,null,[l.multiple&&!l.hideSelected?a(Ea,{key:C.value,modelValue:O,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Ze=>Ze.preventDefault()},null):void 0,C.props.prependAvatar&&a(Ce,{image:C.props.prependAvatar},null),C.props.prependIcon&&a(M,{icon:C.props.prependIcon},null)])},title:()=>o.value?C.title:Ua("v-autocomplete",C.title,T(C)?.title)})}}),f["append-item"]?.()]})]}),e.value.map((E,C)=>{function J(O){O.stopPropagation(),O.preventDefault(),ee(E,!1)}const ue=Q(he.filterProps(E.props),{"onClick:close":J,onKeydown(O){O.key!=="Enter"&&O.key!==" "||(O.preventDefault(),O.stopPropagation(),J(O))},onMousedown(O){O.preventDefault(),O.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),oe=K.value?!!f.chip:!!f.selection,re=oe?wa(K.value?f.chip({item:E,index:C,props:ue}):f.selection({item:E,index:C})):void 0;if(!(oe&&!re))return P("div",{key:E.value,class:_a(["v-autocomplete__selection",C===c.value&&["v-autocomplete__selection--selected",_.value]]),style:ba(C===c.value?y.value:{})},[K.value?f.chip?a(Va,{key:"chip-defaults",defaults:{VChip:{closable:N.value,size:"small",text:E.title}}},{default:()=>[re]}):a(he,Q({key:"chip",closable:N.value,size:"small",text:E.title,disabled:E.props.disabled},ue),null):re??P("span",{class:"v-autocomplete__selection-text"},[E.title,l.multiple&&C<e.value.length-1&&P("span",{class:"v-autocomplete__selection-comma"},[h(",")])])])})])},"append-inner":function(){for(var S=arguments.length,L=new Array(S),E=0;E<S;E++)L[E]=arguments[E];return P(G,null,[f["append-inner"]?.(...L),l.menuIcon?a(M,{class:"v-autocomplete__menu-icon",color:v.value?.fieldIconColor,icon:l.menuIcon,onMousedown:Ne,onClick:pa,"aria-hidden":!0,tabindex:"-1"},null):void 0,l.appendInnerIcon&&a(p,{key:"append-icon",name:"appendInner",color:L[0].iconColor.value},null)])}})}),ua({isFocused:d,isPristine:o,menu:D,search:u,filteredItems:m,select:ee},v)}}),Ga={class:"px-6 pt-3"},Za=Y({__name:"AdminUpdateBasicTab",props:{admin:{}},emits:["saved"],setup(l,{emit:I}){const f=l,k=I,v=g(),d=g([]),o=g(""),w=ce(),b=g(!1),i=g({name:f.admin?.name??"",username:f.admin?.username??"",role_id:f.admin?.role_id??null}),c=g({}),V={required:p=>p?!0:"Required",noSpaces:p=>!p||!/\s/.test(p)?!0:"Username must not contain spaces",lowercase:p=>!p||p===p.toLowerCase()?!0:"Username must be lowercase",allowedChars:p=>!p||/^[a-z0-9_.-]+$/.test(p)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:p=>!p||!p.startsWith(".")&&!p.endsWith(".")?!0:"Dot cannot be the first or last character"};async function R(){const{data:p}=await Pe(),u=Array.isArray(p)?p:p?.data??[];d.value=u.map(e=>({title:e?.name??"",value:e?.id??""})).filter(e=>e.title&&e.value!=="")}function x(p){typeof p=="string"&&(i.value.username=p.toLowerCase()),_("username")}function F(p){return c.value[p]??[]}function _(p){if(!c.value[p])return;const u={...c.value};delete u[p],c.value=u}async function y(){o.value="",c.value={};const p=await v.value?.validate?.();if(!(p&&p.valid===!1)&&!(!p&&v.value?.validate&&!await v.value.validate())){if(!f.admin?.id){o.value="Admin id is required.";return}b.value=!0;try{const u={id:f.admin.id,name:i.value.name,username:i.value.username,role_id:i.value.role_id},{data:e}=await Ta(u),t=e?.data?.updated??e?.updated??!0,s=e?.data?.message??e?.message??"",m=e?.data?.field??e?.field??"";if(t===!1){m?c.value={[m]:[s||"Invalid value."]}:(o.value=s||"Failed to update admin.",w.show({message:o.value,color:"error"}));return}w.show({message:s||"Admin updated successfully.",color:"success"}),k("saved",e??u)}catch(u){const e=u?.response,t=e?.data?.errors??null;if(e?.status===422&&t&&typeof t=="object"){const m={};for(const[T,U]of Object.entries(t))Array.isArray(U)?m[T]=U.map(N=>String(N)):U!=null&&(m[T]=[String(U)]);c.value=m;return}const s=ye(u);console.error("Failed to update admin:",s),o.value=s,w.show({message:s,color:"error"})}finally{b.value=!1}}}return Se(R),(p,u)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(y,["prevent"])},{default:n(()=>[P("div",Ga,[a(ge,null,{default:n(()=>[a(te,null,{default:n(()=>[a($,{cols:"12",md:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:i.value.name,"onUpdate:modelValue":[u[0]||(u[0]=e=>i.value.name=e),u[1]||(u[1]=e=>_("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[V.required],"error-messages":F("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a(B,{modelValue:i.value.username,"onUpdate:modelValue":[u[2]||(u[2]=e=>i.value.username=e),x],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[V.required,V.noSpaces,V.lowercase,V.allowedChars,V.dotPlacement],"error-messages":F("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a($e,{modelValue:i.value.role_id,"onUpdate:modelValue":[u[3]||(u[3]=e=>i.value.role_id=e),u[4]||(u[4]=e=>_("role_id"))],items:d.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[V.required],"error-messages":F("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a($,{cols:"12",class:"d-flex justify-space-around pt-8"},{default:n(()=>[a(H,{color:"primary",size:"large",variant:"tonal",loading:b.value,disabled:b.value,onClick:y},{default:n(()=>[a(M,{start:""},{default:n(()=>[...u[5]||(u[5]=[h("mdi-content-save-outline",-1)])]),_:1}),u[6]||(u[6]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),el={class:"px-6 pt-3"},al=Y({__name:"AdminUpdateEmailTab",props:{admin:{}},emits:["saved"],setup(l,{emit:I}){const f=l,k=I,v=g(),d=g(""),o=g(!1),w=g({email:f.admin?.email??""}),b=g(""),i=g({}),c={required:_=>_?!0:"Required",email:_=>!_||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_)?!0:"Invalid email"};function V(_){return i.value[_]??[]}function R(_){if(!i.value[_])return;const y={...i.value};delete y[_],i.value=y}function x(){R("email")}async function F(){d.value="",i.value={};const _=await v.value?.validate?.();if(!(_&&_.valid===!1)&&!(!_&&v.value?.validate&&!await v.value.validate())){o.value=!0;try{k("saved",{id:f.admin?.id,email:w.value.email,verification_code:b.value||void 0,tab:"email"})}finally{o.value=!1}}}return(_,y)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(F,["prevent"])},{default:n(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:n(()=>[h(j(d.value),1)]),_:1})):fe("",!0),P("div",el,[a(ge,null,{default:n(()=>[a(te,null,{default:n(()=>[a($,{cols:"12",md:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:w.value.email,"onUpdate:modelValue":[y[0]||(y[0]=p=>w.value.email=p),y[1]||(y[1]=p=>R("email"))],label:"New Email",type:"email",variant:"outlined",density:"comfortable",rules:[c.required,c.email],"error-messages":V("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"7",class:"pb-0"},{default:n(()=>[a(B,{modelValue:b.value,"onUpdate:modelValue":[y[2]||(y[2]=p=>b.value=p),y[3]||(y[3]=p=>R("verification_code"))],label:"Verification Code",variant:"outlined",density:"comfortable",rules:[c.required],"error-messages":V("verification_code"),"prepend-inner-icon":"mdi-shield-key-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"5",class:"pb-0"},{default:n(()=>[a(H,{variant:"tonal",color:"primary",size:"large",disabled:o.value,onClick:x},{default:n(()=>[a(M,{start:""},{default:n(()=>[...y[4]||(y[4]=[h("mdi-email-send-outline",-1)])]),_:1}),y[5]||(y[5]=h(" Send Code ",-1))]),_:1},8,["disabled"])]),_:1}),a($,{cols:"12",class:"d-flex justify-space-around pt-8"},{default:n(()=>[a(H,{color:"primary",size:"large",variant:"tonal",loading:o.value,disabled:o.value,onClick:F},{default:n(()=>[a(M,{start:""},{default:n(()=>[...y[6]||(y[6]=[h("mdi-content-save-outline",-1)])]),_:1}),y[7]||(y[7]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),ll={class:"px-6 pt-3"},tl=Y({__name:"AdminUpdatePasswordTab",props:{admin:{}},emits:["saved"],setup(l,{emit:I}){const f=l,k=I,v=g(),d=g(""),o=g(!1),w=ce(),b=g(!1),i=g(!1),c=g({password:"",confirm_password:""}),V=g({}),R={required:u=>u?!0:"Required",passwordMatch:()=>c.value.password===c.value.confirm_password?!0:"Passwords do not match"};function x(u){return V.value[u]??[]}function F(u){if(!V.value[u])return;const e={...V.value};delete e[u],V.value=e}function _(){b.value=!b.value}function y(){i.value=!i.value}async function p(){d.value="",V.value={};const u=await v.value?.validate?.();if(!(u&&u.valid===!1)&&!(!u&&v.value?.validate&&!await v.value.validate())){if(!f.admin?.id){d.value="Admin id is required.",w.show({message:d.value,color:"error"});return}o.value=!0;try{const e={id:f.admin.id,password:c.value.password,confirm_password:c.value.confirm_password},{data:t}=await Oa(e),s=t?.data?.updated??t?.updated??!0,m=t?.data?.message??t?.message??"",T=t?.data?.field??t?.field??"";if(s===!1){T?V.value={[T]:[m||"Invalid value."]}:(d.value=m||"Failed to update password.",w.show({message:d.value,color:"error"}));return}w.show({message:m||"Password updated successfully.",color:"success"}),k("saved",t??e)}catch(e){const t=e?.response,s=t?.data?.errors??null;if(t?.status===422&&s&&typeof s=="object"){const T={};for(const[U,N]of Object.entries(s))Array.isArray(N)?T[U]=N.map(K=>String(K)):N!=null&&(T[U]=[String(N)]);V.value=T;return}const m=ye(e);console.error("Failed to update password:",m),d.value=m,w.show({message:m,color:"error"})}finally{o.value=!1}}}return(u,e)=>(q(),W(ve,{ref_key:"formRef",ref:v,onSubmit:pe(p,["prevent"])},{default:n(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:n(()=>[h(j(d.value),1)]),_:1})):fe("",!0),P("div",ll,[a(ge,null,{default:n(()=>[a(te,null,{default:n(()=>[a($,{cols:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:c.value.password,"onUpdate:modelValue":[e[0]||(e[0]=t=>c.value.password=t),e[1]||(e[1]=t=>F("password"))],label:"New Password",type:b.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[R.required],"error-messages":x("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":b.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":_},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a($,{cols:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:c.value.confirm_password,"onUpdate:modelValue":[e[2]||(e[2]=t=>c.value.confirm_password=t),e[3]||(e[3]=t=>F("confirm_password"))],label:"Confirm Password",type:i.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[R.required,R.passwordMatch],"error-messages":x("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":y},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a($,{cols:"12",class:"d-flex justify-space-around pt-8"},{default:n(()=>[a(H,{color:"primary",size:"large",variant:"tonal",loading:o.value,disabled:o.value,onClick:p},{default:n(()=>[a(M,{start:""},{default:n(()=>[...e[4]||(e[4]=[h("mdi-content-save-outline",-1)])]),_:1}),e[5]||(e[5]=h(" Update ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),nl=Y({__name:"AdminUpdateModal",props:{admin:{}},emits:["close","saved"],setup(l,{emit:I}){const f=l,k=I,v=g("basic"),d=[{value:"basic",label:"Basic Info",component:Za},{value:"password",label:"Password",component:tl},{value:"email",label:"Email",component:al}];function o(w){k("saved",w),k("close")}return(w,b)=>(q(),W(Ae,{class:"pt-4"},{default:n(()=>[a(qa,{modelValue:v.value,"onUpdate:modelValue":b[0]||(b[0]=i=>v.value=i),density:"compact",class:""},{default:n(()=>[(q(),le(G,null,Fe(d,i=>a(Da,{key:i.value,value:i.value},{default:n(()=>[h(j(i.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(De),a(za,{modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=i=>v.value=i)},{default:n(()=>[(q(),le(G,null,Fe(d,i=>a(Ma,{key:i.value,value:i.value,class:"pt-4"},{default:n(()=>[(q(),W(ha(i.component),{admin:f.admin,onSaved:o},null,40,["admin"]))]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}))}});function xe(l,I={},f={}){xa().open(l,I,f)}const sl=Y({__name:"AdminActionButtons",props:{admin:{}},emits:["saved","deleted"],setup(l,{emit:I}){const f=l,k=I;function v(){xe(nl,{admin:f.admin},{title:"Update Admin",size:"md",onSaved:o=>{k("saved",o)}})}function d(){xe(Xa,{admin:f.admin},{title:"Confirm Admin Deletion",size:"sm",onSaved:o=>{k("deleted",o)}})}return(o,w)=>(q(),le(G,null,[a(H,{variant:"tonal",color:"primary",size:"x-small",icon:"",onClick:v},{default:n(()=>[a(M,null,{default:n(()=>[...w[0]||(w[0]=[h("mdi-cog",-1)])]),_:1})]),_:1}),a(H,{variant:"tonal",class:"ml-2",color:"error",size:"x-small",icon:"",onClick:d},{default:n(()=>[a(M,null,{default:n(()=>[...w[1]||(w[1]=[h("mdi-delete",-1)])]),_:1})]),_:1})],64))}}),ol={class:"w-100 d-flex align-center justify-space-between px-4 pt-2"},rl=Y({__name:"AdminCreateModal",emits:["close","saved"],setup(l,{emit:I}){const f=I,k=g(),v=g([]),d=g(""),o=g({name:"",email:"",username:"",role_id:null,password:"",confirm_password:""}),w=g({}),b=g(!1),i=g(!1),c=g(!1),V=ce();async function R(){const{data:e}=await Pe(),t=Array.isArray(e)?e:e?.data??[];v.value=t.map(s=>({title:s?.name??"",value:s?.id??""})).filter(s=>s.title&&s.value!=="")}const x={required:e=>e?!0:"Required",email:e=>!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?!0:"Invalid email",noSpaces:e=>!e||!/\s/.test(e)?!0:"Username must not contain spaces",lowercase:e=>!e||e===e.toLowerCase()?!0:"Username must be lowercase",allowedChars:e=>!e||/^[a-z0-9_.-]+$/.test(e)?!0:"Only letters, numbers, underscore, dash, and dot are allowed",dotPlacement:e=>!e||!e.startsWith(".")&&!e.endsWith(".")?!0:"Dot cannot be the first or last character",passwordMatch:()=>o.value.password===o.value.confirm_password?!0:"Passwords do not match"};function F(e){typeof e=="string"&&(o.value.username=e.toLowerCase()),y("username")}function _(e){return w.value[e]??[]}function y(e){if(!w.value[e])return;const t={...w.value};delete t[e],w.value=t}function p(){o.value={name:"",email:"",username:"",role_id:null,password:"",confirm_password:""},d.value="",w.value={},i.value=!1,c.value=!1,k.value?.resetValidation?.()}async function u(){d.value="",w.value={};const e=await k.value?.validate?.();if(!(e&&e.valid===!1)&&!(!e&&k.value?.validate&&!await k.value.validate())){b.value=!0;try{const t={name:o.value.name,email:o.value.email,username:o.value.username,role_id:o.value.role_id,password:o.value.password,confirm_password:o.value.confirm_password},s=await Ba(t);V.show({message:s?.data?.message||"Admin created successfully.",color:"success"}),f("saved",s.data??t),f("close")}catch(t){const s=t?.response,m=s?.data?.errors??null;if(s?.status===422&&m&&typeof m=="object"){const U={};for(const[N,K]of Object.entries(m))Array.isArray(K)?U[N]=K.map(Z=>String(Z)):K!=null&&(U[N]=[String(K)]);w.value=U;return}const T=ye(t);d.value=T}finally{b.value=!1}}}return Se(R),(e,t)=>(q(),le(G,null,[a(Ae,{class:"py-6"},{default:n(()=>[d.value?(q(),W(me,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:n(()=>[h(j(d.value),1)]),_:1})):fe("",!0),a(ve,{ref_key:"formRef",ref:k,onSubmit:pe(u,["prevent"])},{default:n(()=>[a(te,null,{default:n(()=>[a($,{cols:"12",md:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:o.value.name,"onUpdate:modelValue":[t[0]||(t[0]=s=>o.value.name=s),t[1]||(t[1]=s=>y("name"))],label:"Name",variant:"outlined",density:"comfortable",rules:[x.required],"error-messages":_("name"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"12",class:"pb-0"},{default:n(()=>[a(B,{modelValue:o.value.email,"onUpdate:modelValue":[t[2]||(t[2]=s=>o.value.email=s),t[3]||(t[3]=s=>y("email"))],label:"Email",type:"email",variant:"outlined",density:"comfortable",rules:[x.required,x.email],"error-messages":_("email"),"prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a(B,{modelValue:o.value.username,"onUpdate:modelValue":[t[4]||(t[4]=s=>o.value.username=s),F],label:"Username",variant:"outlined",density:"comfortable",autocomplete:"off",rules:[x.required,x.noSpaces,x.lowercase,x.allowedChars,x.dotPlacement],"error-messages":_("username"),"prepend-inner-icon":"mdi-account-circle-outline"},null,8,["modelValue","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a($e,{modelValue:o.value.role_id,"onUpdate:modelValue":[t[5]||(t[5]=s=>o.value.role_id=s),t[6]||(t[6]=s=>y("role_id"))],items:v.value,label:"Role",variant:"outlined",density:"comfortable",clearable:"",rules:[x.required],"error-messages":_("role_id"),"prepend-inner-icon":"mdi-shield-account-outline"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a(B,{modelValue:o.value.password,"onUpdate:modelValue":[t[7]||(t[7]=s=>o.value.password=s),t[9]||(t[9]=s=>y("password"))],label:"Password",type:i.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[x.required],"error-messages":_("password"),"prepend-inner-icon":"mdi-lock-outline","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":t[8]||(t[8]=s=>i.value=!i.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1}),a($,{cols:"12",md:"6",class:"pb-0"},{default:n(()=>[a(B,{modelValue:o.value.confirm_password,"onUpdate:modelValue":[t[10]||(t[10]=s=>o.value.confirm_password=s),t[12]||(t[12]=s=>y("confirm_password"))],label:"Confirm Password",type:c.value?"text":"password",autocomplete:"off",variant:"outlined",density:"comfortable",rules:[x.required,x.passwordMatch],"error-messages":_("confirm_password"),"prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":c.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":t[11]||(t[11]=s=>c.value=!c.value)},null,8,["modelValue","type","rules","error-messages","append-inner-icon"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(qe,{class:"pb-4"},{default:n(()=>[P("div",ol,[a(H,{icon:"",size:"small",variant:"tonal",title:"Reset form",color:"warning",disabled:b.value,onClick:p,"aria-label":"Reset form"},{default:n(()=>[a(M,null,{default:n(()=>[...t[13]||(t[13]=[h("mdi-refresh",-1)])]),_:1})]),_:1},8,["disabled"]),a(H,{color:"primary",variant:"tonal",class:"px-5",loading:b.value,disabled:b.value,onClick:u},{default:n(()=>[a(M,{start:""},{default:n(()=>[...t[14]||(t[14]=[h("mdi-content-save-outline",-1)])]),_:1}),t[15]||(t[15]=h(" submit ",-1))]),_:1},8,["loading","disabled"])])]),_:1})],64))}}),il=Y({__name:"AdminCreateButton",emits:["saved"],setup(l,{emit:I}){const f=I;function k(){xe(rl,{},{title:"Add Admin",size:"md",onSaved:v=>{f("saved",v)}})}return(v,d)=>(q(),W(H,{color:"primary",variant:"flat",height:"40",onClick:k},{default:n(()=>[a(M,{start:""},{default:n(()=>[...d[0]||(d[0]=[h("mdi-account-plus",-1)])]),_:1}),d[1]||(d[1]=h(" Add Admin ",-1))]),_:1}))}}),ul={class:"text-medium-emphasis"},dl={class:"text-primary",style:{"font-size":"smaller"}},cl={class:"d-flex align-center gap-2"},ml={class:"ml-2"},fl={class:"text-capitalize"},vl={class:"text-medium-emphasis",style:{"font-size":"0.8rem"}},pl={key:1},gl={class:"text-medium-emphasis",style:{"font-size":"0.8rem"}},yl=Y({__name:"AdminListPage",setup(l){const I=[{title:"Name",key:"name",minWidth:"180",sortable:!1},{title:"Role",key:"role",minWidth:"160",sortable:!1},{title:"Email",key:"email",minWidth:"220",sortable:!1},{title:"Created",key:"created_at",minWidth:"100",sortable:!1},{title:"Actions",key:"action",sortable:!1,minWidth:"100"}],f=g([]),k=g(0),v=g(!1),d=g({page:1,itemsPerPage:12,sortBy:[]}),o=g({query:"",role:null}),w=g([]),b=g(!1);async function i(){v.value=!0;try{const{data:t}=await La({page:d.value.page,per_page:d.value.itemsPerPage,search:o.value.query||void 0,role_id:o.value.role??void 0}),s=Array.isArray(t)?t:t?.data??[];f.value=s.map(m=>({...m})),k.value=t?.total??t?.meta?.total??s.length}finally{v.value=!1}}function c(t){d.value=t,b.value||(b.value=!0),i()}function V(){d.value.page=1,i()}function R(t){t||(d.value.page=1,i())}function x(t){t||(d.value.page=1,i())}function F(){d.value.page=1,i()}function _(){d.value.page=1,i()}function y(){d.value.page=1,i()}async function p(){const{data:t}=await Pe(),s=Array.isArray(t)?t:t?.data??[];w.value=s.map(m=>({title:m?.name??"",value:m?.id??""})).filter(m=>m.title&&m.value!=="")}function u(t){const s=t.trim().toLowerCase().replace(/\s+/g,"-"),m={"content-writer":"warning",administrator:"primary",manager:"success",csr:"orange"};return m[s]?m[s]:s.includes("admin")?"primary":s.includes("manager")?"success":s.includes("writer")?"warning":s.includes("csr")?"orange":"grey"}function e(t){const s=t.trim().toLowerCase().replace(/\s+/g,"-"),m={"content-writer":"mdi-pencil",administrator:"mdi-shield-crown-outline",manager:"mdi-briefcase-account-outline",csr:"mdi-headset"};return m[s]?m[s]:s.includes("admin")?"mdi-shield-account-outline":s.includes("manager")?"mdi-briefcase-account-outline":s.includes("writer")?"mdi-pencil":s.includes("csr")?"mdi-headset":"mdi-account-circle-outline"}return Se(()=>{b.value||(i(),b.value=!0),p()}),(t,s)=>(q(),W(ea,{headers:I,items:f.value,total:k.value,loading:v.value,"items-per-page":d.value.itemsPerPage,"onUpdate:options":c},{actions:n(()=>[a(ge,{fluid:""},{default:n(()=>[a(te,null,{default:n(()=>[a($,{cols:"12",md:"3"},{default:n(()=>[a(B,{modelValue:o.value.query,"onUpdate:modelValue":[s[0]||(s[0]=m=>o.value.query=m),R],density:"compact",variant:"outlined",label:"Search",placeholder:"Search by name, email, or username","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"3"},{default:n(()=>[a($e,{modelValue:o.value.role,"onUpdate:modelValue":[s[1]||(s[1]=m=>o.value.role=m),x],items:w.value,density:"compact",variant:"outlined",label:"Role","prepend-inner-icon":"mdi-shield-account-outline","hide-details":"",clearable:"",style:{"min-width":"200px"}},null,8,["modelValue","items"])]),_:1}),a($,{cols:"12",md:"2",class:"d-flex align-center"},{default:n(()=>[a(H,{color:"primary",variant:"tonal",height:"40",onClick:V},{default:n(()=>[a(M,{start:""},{default:n(()=>[...s[2]||(s[2]=[h("mdi-magnify",-1)])]),_:1}),s[3]||(s[3]=h(" Search ",-1))]),_:1})]),_:1}),a($,{cols:"12",md:"4",class:"d-flex align-center justify-end"},{default:n(()=>[a(il,{onSaved:F})]),_:1})]),_:1}),a(te,null,{default:n(()=>[a($,{cols:"12"},{default:n(()=>[P("div",ul,[P("span",dl," Total: "+j(k.value)+" Items found. ",1)])]),_:1})]),_:1})]),_:1})]),"item.name":n(({item:m})=>[P("div",cl,[a(Ce,{size:"28",color:"grey-lighten-3"},{default:n(()=>[a(M,{size:"18",color:"grey-darken-1"},{default:n(()=>[...s[4]||(s[4]=[h("mdi-account-circle",-1)])]),_:1})]),_:1}),P("div",ml,[P("div",fl,j(m.name??"-"),1),P("div",vl," @"+j(m.username??"no.username"),1)])])]),"item.role":n(({item:m})=>[m.role?(q(),W(he,{key:0,size:"small",variant:"tonal",class:"text-uppercase font-weight-bold",color:u(m.role),label:""},{default:n(()=>[a(M,{start:"",size:"14"},{default:n(()=>[h(j(e(m.role)),1)]),_:2},1024),h(" "+j(m.role),1)]),_:2},1032,["color"])):(q(),le("span",pl,"-"))]),"item.action":n(({item:m})=>[a(sl,{admin:m,onSaved:_,onDeleted:y},null,8,["admin"])]),"item.created_at":n(({item:m})=>[P("span",gl,j(m.created_at??"-"),1)]),_:1},8,["items","total","loading","items-per-page"]))}}),kl=Ca(yl,[["__scopeId","data-v-8e4dd856"]]);export{kl as default};
